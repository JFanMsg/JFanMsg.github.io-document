(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{378:function(t,s,a){"use strict";a.r(s);var e=a(45),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_3-kubectl远程连接k8s集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-kubectl远程连接k8s集群"}},[t._v("#")]),t._v(" 3. kubectl远程连接K8S集群")]),t._v(" "),a("h1",{attrs:{id:"kubectl远程连接k8s集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubectl远程连接k8s集群"}},[t._v("#")]),t._v(" kubectl远程连接K8S集群")]),t._v(" "),a("p",[t._v("基于上面的集群实验")]),t._v(" "),a("p",[t._v("会在已生成k8s证书目录中生成文件")]),t._v(" "),a("p",[t._v("证明没有在k8s集群中，也是可以通过这种方式来连接集群的")]),t._v(" "),a("h2",{attrs:{id:"编写连接脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写连接脚本"}},[t._v("#")]),t._v(" 编写连接脚本")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /k8s/cert/k8s-cert/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" k8sd.sh\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nkubectl config set-cluster kubernetes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://192.168.0.42:6443 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--embed-certs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--certificate-authority"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ca.pem "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--kubeconfig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("config\nkubectl config set-credentials cluster-admin "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--certificate-authority"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ca.pem "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--embed-certs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--client-key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("admin-key.pem "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--client-certificate"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("admin.pem "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--kubeconfig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("config\nkubectl config set-context default --cluster"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("kubernetes --user"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("cluster-admin --kubeconfig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("config\nkubectl config use-context default --kubeconfig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("config\n")])])]),a("h2",{attrs:{id:"移动文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#移动文件"}},[t._v("#")]),t._v(" 移动文件")]),t._v(" "),a("p",[t._v("将移动生成的config，以及k8s的管理文件kubectl，移动到nginx节点之一上")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" config root@192.168.0.42:/root\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" /usr/local/kubernetes/bin/kubectl root@192.168.0.42:/usr/bin\n")])])]),a("h2",{attrs:{id:"测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[t._v("#")]),t._v(" 测试")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /root\nkubectl --kubeconfig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./config get node\nNAME            STATUS   ROLES    AGE   VERSION\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.142   Ready    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("   28h   v1.13.4\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.143   Ready    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("   26h   v1.13.4\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);