(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{400:function(t,a,s){"use strict";s.r(a);var e=s(45),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_2-go的依赖管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-go的依赖管理"}},[t._v("#")]),t._v(" 2. GO的依赖管理")]),t._v(" "),s("h1",{attrs:{id:"依赖管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#依赖管理"}},[t._v("#")]),t._v(" 依赖管理")]),t._v(" "),s("h2",{attrs:{id:"为什么需要依赖管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要依赖管理"}},[t._v("#")]),t._v(" 为什么需要依赖管理")]),t._v(" "),s("p",[t._v("最早的时候，Go所依赖的所有的第三方库都放在GOPATH这个目录下面。这就导致了同一个库只能保存一个版本的代码。如果不同的项目依赖同一个第三方的库的不同版本，应该怎么解决？")]),t._v(" "),s("h2",{attrs:{id:"godep依赖管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#godep依赖管理"}},[t._v("#")]),t._v(" godep依赖管理")]),t._v(" "),s("p",[t._v("Go语言从v1.5开始开始引入"),s("code",[t._v("vendor")]),t._v("模式，如果项目目录下有vendor目录，那么go工具链会优先使用"),s("code",[t._v("vendor")]),t._v("内的包进行编译、测试等")]),t._v(" "),s("p",[s("code",[t._v("godep")]),t._v("是一个通过vender模式实现的Go语言的第三方依赖管理工具，类似的还有由社区维护准官方包管理工具"),s("code",[t._v("dep")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" get github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tools"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("godep\n")])])]),s("h3",{attrs:{id:"基本命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本命令"}},[t._v("#")]),t._v(" 基本命令")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 安装好godep之后，在终端输入godep查看支持的所有命令。")]),t._v("\n\ngodep save     将依赖项输出并复制到Godeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json文件中\ngodep "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v("       使用保存的依赖项运行"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v("工具\ngodep get      下载并安装具有指定依赖项的包\ngodep path     打印依赖的GOPATH路径\ngodep restore  在GOPATH中拉取依赖的版本\ngodep update   更新选定的包或"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v("版本\ngodep diff     显示当前和以前保存的依赖项集之间的差异\ngodep version  查看版本信息\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使用godep help [command]可以看看具体命令的帮助信息")]),t._v("\n")])])]),s("h3",{attrs:{id:"使用godep"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用godep"}},[t._v("#")]),t._v(" 使用godep")]),t._v(" "),s("p",[t._v("在项目目录下执行"),s("code",[t._v("godep save")]),t._v("命令，会在当前项目中创建"),s("code",[t._v("Godeps")]),t._v("和"),s("code",[t._v("vender")]),t._v("两个文件夹。")]),t._v(" "),s("p",[t._v("其中"),s("code",[t._v("Godeps")]),t._v("文件夹下有一个"),s("code",[t._v("Godeps.json")]),t._v("的文件，里面记录了项目所依赖的包信息。 "),s("code",[t._v("vender")]),t._v("文件夹下是项目依赖的包的源代码文件。")]),t._v(" "),s("h3",{attrs:{id:"vender机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vender机制"}},[t._v("#")]),t._v(" vender机制")]),t._v(" "),s("p",[t._v("Go1.5版本之后开始支持，能够控制Go语言程序编译时依赖包搜索路径的优先级。")]),t._v(" "),s("p",[t._v("例如查找项目的某个依赖包，首先会在项目根目录下的"),s("code",[t._v("vender")]),t._v("文件夹中查找，如果没有找到就会去"),s("code",[t._v("$GOAPTH/src")]),t._v("目录下查找")]),t._v(" "),s("h3",{attrs:{id:"godep开发流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#godep开发流程"}},[t._v("#")]),t._v(" godep开发流程")]),t._v(" "),s("ol",[s("li",[t._v("保证程序能够正常编译")]),t._v(" "),s("li",[t._v("执行"),s("code",[t._v("godep save")]),t._v("保存当前项目的所有第三方依赖的版本信息和代码")]),t._v(" "),s("li",[t._v("提交Godeps目录和vender目录到代码库。")]),t._v(" "),s("li",[t._v("如果要更新依赖的版本，可以直接修改"),s("code",[t._v("Godeps.json")]),t._v("文件中的对应项")])]),t._v(" "),s("h2",{attrs:{id:"go-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-module"}},[t._v("#")]),t._v(" go module")]),t._v(" "),s("p",[s("code",[t._v("go module")]),t._v("是Go1.11版本之后官方推出的版本管理工具，并且从Go1.13版本开始，"),s("code",[t._v("go module")]),t._v("将是Go语言默认的依赖管理工具。")]),t._v(" "),s("h3",{attrs:{id:"配置go111module环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置go111module环境变量"}},[t._v("#")]),t._v(" 配置GO111MODULE环境变量")]),t._v(" "),s("p",[t._v("要启用"),s("code",[t._v("go module")]),t._v("支持首先要设置环境变量"),s("code",[t._v("GO111MODULE")]),t._v("，通过它可以开启或关闭模块支持，它有三个可选值："),s("code",[t._v("off")]),t._v("、"),s("code",[t._v("on")]),t._v("、"),s("code",[t._v("auto")]),t._v("，默认值是"),s("code",[t._v("auto")]),t._v("。")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("GO111MODULE=off")]),t._v("禁用模块支持，编译时会从"),s("code",[t._v("GOPATH")]),t._v("和"),s("code",[t._v("vendor")]),t._v("文件夹中查找包。")]),t._v(" "),s("li",[s("code",[t._v("GO111MODULE=on")]),t._v("启用模块支持，编译时会忽略"),s("code",[t._v("GOPATH")]),t._v("和"),s("code",[t._v("vendor")]),t._v("文件夹，只根据 "),s("code",[t._v("go.mod")]),t._v("下载依赖。")]),t._v(" "),s("li",[s("code",[t._v("GO111MODULE=auto")]),t._v("，当项目在"),s("code",[t._v("$GOPATH/src")]),t._v("外且项目根目录有"),s("code",[t._v("go.mod")]),t._v("文件时，开启模块支持。")])]),t._v(" "),s("p",[t._v("简单来说，设置"),s("code",[t._v("GO111MODULE=on")]),t._v("之后就可以使用"),s("code",[t._v("go module")]),t._v("了，以后就没有必要在GOPATH中创建项目了，并且还能够很好的管理项目依赖的第三方包信息。")]),t._v(" "),s("p",[t._v("使用 go module 管理依赖后会在项目根目录下生成两个文件"),s("code",[t._v("go.mod")]),t._v("和"),s("code",[t._v("go.sum")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"go下载依赖源地址goproxy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go下载依赖源地址goproxy"}},[t._v("#")]),t._v(" go下载依赖源地址GOPROXY")]),t._v(" "),s("p",[t._v("Go1.11之后设置GOPROXY命令为：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("export GOPROXY"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("goproxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cn\n")])])]),s("p",[t._v("Go1.13之后"),s("code",[t._v("GOPROXY")]),t._v("默认值为"),s("code",[t._v("https://proxy.golang.org")]),t._v("，在国内是无法访问的，推荐使用"),s("a",{attrs:{href:"https://studygolang.com/topics/10014",target:"_blank",rel:"noopener noreferrer"}},[t._v("goproxy.cn"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" env "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("w GOPROXY"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("goproxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("direct\n")])])]),s("h3",{attrs:{id:"go-mod命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-mod命令"}},[t._v("#")]),t._v(" go mod命令")]),t._v(" "),s("p",[t._v("常用的"),s("code",[t._v("go mod")]),t._v("命令如下：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" mod download    下载依赖的module到本地cache（默认为$GOPATH"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("pkg"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mod目录）\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" mod edit        编辑"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mod文件\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" mod graph       打印模块依赖图\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" mod init        初始化当前文件夹"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 创建"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mod文件\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" mod tidy        增加缺少的module，删除无用的module\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" mod vendor      将依赖复制到vendor下\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" mod verify      校验依赖\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" mod why         解释为什么需要依赖\n")])])]),s("h3",{attrs:{id:"go-mod文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-mod文件"}},[t._v("#")]),t._v(" go.mod文件")]),t._v(" "),s("p",[t._v("go.mod文件记录了项目所有的依赖信息，其结构大致如下：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("module github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Q1mi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("studygo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("blogger\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.12")]),t._v("\n\nrequire "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\tgithub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("DeanThompson"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ginpprof v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20190408063150")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("be636683586\n\tgithub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("gin"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("gonic"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("gin v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.0")]),t._v("\n\tgithub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("sql"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("driver"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mysql v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.1")]),t._v("\n\tgithub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jmoiron"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sqlx v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),t._v("\n\tgithub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("satori"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("uuid v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),t._v("\n\tgoogle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("golang"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("appengine v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6.1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// indirect")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// module用来定义包名")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// require用来定义依赖包及版本")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// indirect表示间接引用")]),t._v("\n")])])]),s("p",[s("strong",[t._v("依赖的版本")])]),t._v(" "),s("p",[t._v("go mod支持语义化版本号，比如"),s("code",[t._v("go get foo@v1.2.3")]),t._v("，也可以跟git的分支或tag，比如"),s("code",[t._v("go get foo@master")]),t._v("，当然也可以跟git提交哈希，比如"),s("code",[t._v("go get foo@e3702bed2")]),t._v("。关于依赖的版本支持以下几种格式：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("gopkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("in"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tomb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("v1 v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20141024135613")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dd632973f1e7\ngopkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("in"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vmihailenco"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("msgpack"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("v2 v2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9.1")]),t._v("\ngopkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("in"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("yaml"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("v2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("v2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.1")]),t._v("\ngithub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tatsushid"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("fastping v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20160109021039")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d7bb493dee3e\nlatest\n")])])]),s("p",[s("strong",[t._v("replace")])]),t._v(" "),s("p",[t._v("在国内访问golang.org/x的各个包都需要翻墙，你可以在go.mod中使用replace替换成github上对应的库")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("replace "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\tgolang"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("crypto v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20180820150726")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("614")]),t._v("d502a4dac "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("golang"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("crypto v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20180820150726")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("614")]),t._v("d502a4dac\n\tgolang"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("net v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20180821023952")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("922")]),t._v("f4815f713 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("golang"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("net v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20180826012351")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("a410e7b638d\n\tgolang"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("text v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("golang"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("text v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"go-get下载或更新依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-get下载或更新依赖"}},[t._v("#")]),t._v(" go get下载或更新依赖")]),t._v(" "),s("p",[t._v("在项目中执行"),s("code",[t._v("go get")]),t._v("命令可以下载依赖包，并且还可以指定下载的版本。")]),t._v(" "),s("ol",[s("li",[t._v("运行"),s("code",[t._v("go get -u")]),t._v("将会升级到最新的次要版本或者修订版本(x.y.z, z是修订版本号， y是次要版本号)")]),t._v(" "),s("li",[t._v("运行"),s("code",[t._v("go get -u=patch")]),t._v("将会升级到最新的修订版本")]),t._v(" "),s("li",[t._v("运行"),s("code",[t._v("go get package@version")]),t._v("将会升级到指定的版本号version")])]),t._v(" "),s("p",[t._v("如果下载所有依赖可以使用"),s("code",[t._v("go mod download")]),t._v("命令。")]),t._v(" "),s("h3",{attrs:{id:"整理依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#整理依赖"}},[t._v("#")]),t._v(" 整理依赖")]),t._v(" "),s("p",[t._v("我们在代码中删除依赖代码后，相关的依赖库并不会在"),s("code",[t._v("go.mod")]),t._v("文件中自动移除。这种情况下我们可以使用"),s("code",[t._v("go mod tidy")]),t._v("命令更新"),s("code",[t._v("go.mod")]),t._v("中的依赖关系。")]),t._v(" "),s("h3",{attrs:{id:"go-mod-edit-格式化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-mod-edit-格式化"}},[t._v("#")]),t._v(" go mod edit 格式化")]),t._v(" "),s("p",[t._v("因为我们可以手动修改go.mod文件，所以有些时候需要格式化该文件。Go提供了一下命令：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("go mod edit -fmt\n")])])]),s("p",[s("strong",[t._v("添加依赖项")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("go mod edit -require"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("golang.org/x/text\n")])])]),s("p",[s("strong",[t._v("移除依赖项")])]),t._v(" "),s("p",[t._v("如果只是想修改"),s("code",[t._v("go.mod")]),t._v("文件中的内容，那么可以运行"),s("code",[t._v("go mod edit -droprequire=package path")]),t._v("，比如要在"),s("code",[t._v("go.mod")]),t._v("中移除"),s("code",[t._v("golang.org/x/text")]),t._v("包，可以使用如下命令：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("go mod edit -droprequire"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("golang.org/x/text\n")])])]),s("p",[t._v("关于"),s("code",[t._v("go mod edit")]),t._v("的更多用法可以通过"),s("code",[t._v("go help mod edit")]),t._v("查看。")]),t._v(" "),s("h2",{attrs:{id:"在项目中使用go-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在项目中使用go-module"}},[t._v("#")]),t._v(" 在项目中使用go module")]),t._v(" "),s("p",[s("strong",[t._v("既有项目")])]),t._v(" "),s("p",[t._v("如果需要对一个已经存在的项目启用"),s("code",[t._v("go module")]),t._v("，可以按照以下步骤操作：")]),t._v(" "),s("ol",[s("li",[t._v("在项目目录下执行"),s("code",[t._v("go mod init")]),t._v("，生成一个"),s("code",[t._v("go.mod")]),t._v("文件。")]),t._v(" "),s("li",[t._v("执行"),s("code",[t._v("go get")]),t._v("，查找并记录当前项目的依赖，同时生成一个"),s("code",[t._v("go.sum")]),t._v("记录每个依赖库的版本和哈希值。")])]),t._v(" "),s("p",[s("strong",[t._v("新项目")])]),t._v(" "),s("p",[t._v("对于一个新创建的项目，我们可以在项目文件夹下按照以下步骤操作：")]),t._v(" "),s("ol",[s("li",[t._v("执行"),s("code",[t._v("go mod init 项目名")]),t._v("命令，在当前项目文件夹下创建一个"),s("code",[t._v("go.mod")]),t._v("文件。")]),t._v(" "),s("li",[t._v("手动编辑"),s("code",[t._v("go.mod")]),t._v("中的require依赖项或执行"),s("code",[t._v("go get")]),t._v("自动发现、维护依赖。")])]),t._v(" "),s("h1",{attrs:{id:"go-module导入本地包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-module导入本地包"}},[t._v("#")]),t._v(" go module导入本地包")]),t._v(" "),s("p",[s("code",[t._v("go module")]),t._v("是Go1.11版本之后官方推出的版本管理工具，并且从"),s("code",[t._v("Go1.13")]),t._v("版本开始，"),s("code",[t._v("go module")]),t._v("将是Go语言默认的依赖管理工具。到今天"),s("code",[t._v("Go1.14")]),t._v("版本推出之后"),s("code",[t._v("Go modules")]),t._v(" 功能已经被正式推荐在生产环境下使用了。")]),t._v(" "),s("h2",{attrs:{id:"前提条件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前提条件"}},[t._v("#")]),t._v(" 前提条件")]),t._v(" "),s("p",[t._v("假设我们现在有"),s("code",[t._v("moduledemo")]),t._v("和"),s("code",[t._v("mypackage")]),t._v("两个包，其中"),s("code",[t._v("moduledemo")]),t._v("包中会导入"),s("code",[t._v("mypackage")]),t._v("包并使用它的"),s("code",[t._v("New")]),t._v("方法。")]),t._v(" "),s("p",[s("code",[t._v("mypackage/mypackage.go")]),t._v("内容如下：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" mypackage\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fmt"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tfmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mypackage.New"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("我们现在分两种情况讨论：")]),t._v(" "),s("h2",{attrs:{id:"在同一个项目下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在同一个项目下"}},[t._v("#")]),t._v(" 在同一个项目下")]),t._v(" "),s("p",[s("strong",[t._v("注意")]),t._v("：在一个项目（project）下我们是可以定义多个包（package）的。")]),t._v(" "),s("h3",{attrs:{id:"目录结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),s("p",[t._v("现在的情况是，我们在"),s("code",[t._v("moduledemo/main.go")]),t._v("中调用了"),s("code",[t._v("mypackage")]),t._v("这个包。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("moduledemo\n├── go.mod\n├── main.go\n└── mypackage\n    └── mypackage.go\n")])])]),s("h3",{attrs:{id:"导入包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入包"}},[t._v("#")]),t._v(" 导入包")]),t._v(" "),s("p",[t._v("这个时候，我们需要在"),s("code",[t._v("moduledemo/go.mod")]),t._v("中按如下定义：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("module moduledemo\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v("\n")])])]),s("p",[t._v("然后在"),s("code",[t._v("moduledemo/main.go")]),t._v("中按如下方式导入"),s("code",[t._v("mypackage")])]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" main\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fmt"')]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"moduledemo/mypackage"')]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 导入同一项目下的mypackage包")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tmypackage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tfmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"举个例子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#举个例子"}},[t._v("#")]),t._v(" 举个例子")]),t._v(" "),s("p",[t._v("举一反三，假设我们现在有文件目录结构如下：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("└── bubble\n    ├── dao\n    │   └── mysql.go\n    ├── go.mod\n    └── main.go\n")])])]),s("p",[t._v("其中"),s("code",[t._v("bubble/go.mod")]),t._v("内容如下：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("module github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("q1mi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bubble\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v("\n")])])]),s("p",[s("code",[t._v("bubble/dao/mysql.go")]),t._v("内容如下：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" dao\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fmt"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tfmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mypackage.New"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("code",[t._v("bubble/main.go")]),t._v("内容如下：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" main\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fmt"')]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"github.com/q1mi/bubble/dao"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tdao"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tfmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"不在同一个项目下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#不在同一个项目下"}},[t._v("#")]),t._v(" 不在同一个项目下")]),t._v(" "),s("h3",{attrs:{id:"目录结构-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目录结构-2"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("├── moduledemo\n│   ├── go.mod\n│   └── main.go\n└── mypackage\n    ├── go.mod\n    └── mypackage.go\n")])])]),s("h3",{attrs:{id:"导入包-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入包-2"}},[t._v("#")]),t._v(" 导入包")]),t._v(" "),s("p",[t._v("这个时候，"),s("code",[t._v("mypackage")]),t._v("也需要进行module初始化，即拥有一个属于自己的"),s("code",[t._v("go.mod")]),t._v("文件，内容如下：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("module mypackage\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v("\n")])])]),s("p",[t._v("然后我们在"),s("code",[t._v("moduledemo/main.go")]),t._v("中按如下方式导入：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fmt"')]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mypackage"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tmypackage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tfmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("因为这两个包不在同一个项目路径下，你想要导入本地包，并且这些包也没有发布到远程的github或其他代码仓库地址。这个时候我们就需要在"),s("code",[t._v("go.mod")]),t._v("文件中使用"),s("code",[t._v("replace")]),t._v("指令。")]),t._v(" "),s("p",[t._v("在调用方也就是"),s("code",[t._v("moduledemo/go.mod")]),t._v("中按如下方式指定使用相对路径来寻找"),s("code",[t._v("mypackage")]),t._v("这个包。")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("module moduledemo\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v("\n\n\nrequire "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mypackage"')]),t._v(" v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v("\nreplace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mypackage"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../mypackage"')]),t._v("\n")])])]),s("h3",{attrs:{id:"举个例子-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#举个例子-2"}},[t._v("#")]),t._v(" 举个例子")]),t._v(" "),s("p",[t._v("最后我们再举个例子巩固下上面的内容。")]),t._v(" "),s("p",[t._v("我们现在有文件目录结构如下：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("├── p1\n│   ├── go.mod\n│   └── main.go\n└── p2\n    ├── go.mod\n    └── p2.go\n")])])]),s("p",[s("code",[t._v("p1/main.go")]),t._v("中想要导入"),s("code",[t._v("p2.go")]),t._v("中定义的函数。")]),t._v(" "),s("p",[s("code",[t._v("p2/go.mod")]),t._v("内容如下：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("module liwenzhou"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("q1mi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p2\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v("\n")])])]),s("p",[s("code",[t._v("p1/main.go")]),t._v("中按如下方式导入")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fmt"')]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"liwenzhou.com/q1mi/p2"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tp2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tfmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("因为我并没有把"),s("code",[t._v("liwenzhou.com/q1mi/p2")]),t._v("这个包上传到"),s("code",[t._v("liwenzhou.com")]),t._v("这个网站，我们只是想导入本地的包，这个时候就需要用到"),s("code",[t._v("replace")]),t._v("这个指令了。")]),t._v(" "),s("p",[s("code",[t._v("p1/go.mod")]),t._v("内容如下：")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("module github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("q1mi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p1\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v("\n\n\nrequire "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"liwenzhou.com/q1mi/p2"')]),t._v(" v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v("\nreplace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"liwenzhou.com/q1mi/p2"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../p2"')]),t._v("\n")])])]),s("p",[t._v("此时，我们就可以正常编译"),s("code",[t._v("p1")]),t._v("这个项目了。")])])}),[],!1,null,null,null);a.default=n.exports}}]);