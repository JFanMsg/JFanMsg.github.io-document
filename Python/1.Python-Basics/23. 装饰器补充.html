<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>23. 装饰器补充 | MSG</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="在追寻技术的同时享受生活">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.d65bef42.js" as="script"><link rel="preload" href="/assets/js/2.2249178e.js" as="script"><link rel="preload" href="/assets/js/74.64c81a90.js" as="script"><link rel="prefetch" href="/assets/js/10.4785e2e5.js"><link rel="prefetch" href="/assets/js/100.33fceff2.js"><link rel="prefetch" href="/assets/js/101.62e1e5d4.js"><link rel="prefetch" href="/assets/js/102.8551fe71.js"><link rel="prefetch" href="/assets/js/103.47754d79.js"><link rel="prefetch" href="/assets/js/104.4adf114f.js"><link rel="prefetch" href="/assets/js/105.6206a08a.js"><link rel="prefetch" href="/assets/js/106.1c4561f3.js"><link rel="prefetch" href="/assets/js/107.e1531a5a.js"><link rel="prefetch" href="/assets/js/108.c637743a.js"><link rel="prefetch" href="/assets/js/109.3f150913.js"><link rel="prefetch" href="/assets/js/11.bd8ec7a6.js"><link rel="prefetch" href="/assets/js/110.088c1ac3.js"><link rel="prefetch" href="/assets/js/111.66d8d491.js"><link rel="prefetch" href="/assets/js/112.231663ee.js"><link rel="prefetch" href="/assets/js/113.a38bc531.js"><link rel="prefetch" href="/assets/js/114.e165daea.js"><link rel="prefetch" href="/assets/js/115.994b087a.js"><link rel="prefetch" href="/assets/js/116.ea3cfdfb.js"><link rel="prefetch" href="/assets/js/117.7be5e4f3.js"><link rel="prefetch" href="/assets/js/118.ebb58ddb.js"><link rel="prefetch" href="/assets/js/119.90018646.js"><link rel="prefetch" href="/assets/js/12.0d8f43df.js"><link rel="prefetch" href="/assets/js/120.bb5be863.js"><link rel="prefetch" href="/assets/js/121.3d1db670.js"><link rel="prefetch" href="/assets/js/122.d29ed1b2.js"><link rel="prefetch" href="/assets/js/123.38cc4704.js"><link rel="prefetch" href="/assets/js/124.cc8549d4.js"><link rel="prefetch" href="/assets/js/125.6ee3e9c8.js"><link rel="prefetch" href="/assets/js/126.48710eba.js"><link rel="prefetch" href="/assets/js/127.d7a1fd83.js"><link rel="prefetch" href="/assets/js/128.e5017f6b.js"><link rel="prefetch" href="/assets/js/129.4c33e121.js"><link rel="prefetch" href="/assets/js/13.2dbde7aa.js"><link rel="prefetch" href="/assets/js/130.cda66247.js"><link rel="prefetch" href="/assets/js/131.ad76f669.js"><link rel="prefetch" href="/assets/js/132.aca88758.js"><link rel="prefetch" href="/assets/js/133.a1cf5903.js"><link rel="prefetch" href="/assets/js/134.b1386377.js"><link rel="prefetch" href="/assets/js/135.94edcf53.js"><link rel="prefetch" href="/assets/js/136.24be4170.js"><link rel="prefetch" href="/assets/js/137.db57772e.js"><link rel="prefetch" href="/assets/js/138.dc67bcaa.js"><link rel="prefetch" href="/assets/js/139.5453d1f6.js"><link rel="prefetch" href="/assets/js/14.2187dbf4.js"><link rel="prefetch" href="/assets/js/140.938e5c07.js"><link rel="prefetch" href="/assets/js/141.99c7cf2c.js"><link rel="prefetch" href="/assets/js/142.428e3958.js"><link rel="prefetch" href="/assets/js/143.68b01530.js"><link rel="prefetch" href="/assets/js/144.f67389cc.js"><link rel="prefetch" href="/assets/js/145.d952a130.js"><link rel="prefetch" href="/assets/js/146.b933dcad.js"><link rel="prefetch" href="/assets/js/147.2d8e4c0a.js"><link rel="prefetch" href="/assets/js/148.6d76ac94.js"><link rel="prefetch" href="/assets/js/149.6b4d6378.js"><link rel="prefetch" href="/assets/js/15.a53b356c.js"><link rel="prefetch" href="/assets/js/150.5bf39cb4.js"><link rel="prefetch" href="/assets/js/151.17af677c.js"><link rel="prefetch" href="/assets/js/152.7f1c2792.js"><link rel="prefetch" href="/assets/js/153.98dd0727.js"><link rel="prefetch" href="/assets/js/154.eb44bf23.js"><link rel="prefetch" href="/assets/js/155.5a9840ea.js"><link rel="prefetch" href="/assets/js/156.7ba01fd0.js"><link rel="prefetch" href="/assets/js/157.2296a048.js"><link rel="prefetch" href="/assets/js/158.6bb1f699.js"><link rel="prefetch" href="/assets/js/159.073bb8df.js"><link rel="prefetch" href="/assets/js/16.cef7bf44.js"><link rel="prefetch" href="/assets/js/160.25a837f9.js"><link rel="prefetch" href="/assets/js/161.93d886a1.js"><link rel="prefetch" href="/assets/js/162.5d2714b2.js"><link rel="prefetch" href="/assets/js/17.96f36904.js"><link rel="prefetch" href="/assets/js/18.fd04b310.js"><link rel="prefetch" href="/assets/js/19.3e1377d1.js"><link rel="prefetch" href="/assets/js/20.ac195ac8.js"><link rel="prefetch" href="/assets/js/21.c2d7729c.js"><link rel="prefetch" href="/assets/js/22.dd8c621b.js"><link rel="prefetch" href="/assets/js/23.ad7d0350.js"><link rel="prefetch" href="/assets/js/24.8559c4c3.js"><link rel="prefetch" href="/assets/js/25.783a8116.js"><link rel="prefetch" href="/assets/js/26.25e0e459.js"><link rel="prefetch" href="/assets/js/27.c0616e2a.js"><link rel="prefetch" href="/assets/js/28.30656c2e.js"><link rel="prefetch" href="/assets/js/29.2be5114c.js"><link rel="prefetch" href="/assets/js/3.be8c8f3b.js"><link rel="prefetch" href="/assets/js/30.230a74a7.js"><link rel="prefetch" href="/assets/js/31.760f46ad.js"><link rel="prefetch" href="/assets/js/32.c9533fef.js"><link rel="prefetch" href="/assets/js/33.dcacfb38.js"><link rel="prefetch" href="/assets/js/34.4370a466.js"><link rel="prefetch" href="/assets/js/35.bf299eea.js"><link rel="prefetch" href="/assets/js/36.336e435a.js"><link rel="prefetch" href="/assets/js/37.1d1d2eea.js"><link rel="prefetch" href="/assets/js/38.0d58b7d0.js"><link rel="prefetch" href="/assets/js/39.d43564ba.js"><link rel="prefetch" href="/assets/js/4.4a6cb970.js"><link rel="prefetch" href="/assets/js/40.bc4e4bde.js"><link rel="prefetch" href="/assets/js/41.b71231a5.js"><link rel="prefetch" href="/assets/js/42.9d46f400.js"><link rel="prefetch" href="/assets/js/43.50c5be69.js"><link rel="prefetch" href="/assets/js/44.60406e7f.js"><link rel="prefetch" href="/assets/js/45.ec3569ae.js"><link rel="prefetch" href="/assets/js/46.1bd3ce7b.js"><link rel="prefetch" href="/assets/js/47.1e1b5326.js"><link rel="prefetch" href="/assets/js/48.64c631ea.js"><link rel="prefetch" href="/assets/js/49.b4abacd8.js"><link rel="prefetch" href="/assets/js/5.e6d0b165.js"><link rel="prefetch" href="/assets/js/50.c3e320c0.js"><link rel="prefetch" href="/assets/js/51.5ec7fb8c.js"><link rel="prefetch" href="/assets/js/52.2d234f86.js"><link rel="prefetch" href="/assets/js/53.f3b69623.js"><link rel="prefetch" href="/assets/js/54.c85ff450.js"><link rel="prefetch" href="/assets/js/55.b07597b5.js"><link rel="prefetch" href="/assets/js/56.444129cf.js"><link rel="prefetch" href="/assets/js/57.df1329ba.js"><link rel="prefetch" href="/assets/js/58.5afb51cf.js"><link rel="prefetch" href="/assets/js/59.d98936d9.js"><link rel="prefetch" href="/assets/js/6.809376cd.js"><link rel="prefetch" href="/assets/js/60.02813ecf.js"><link rel="prefetch" href="/assets/js/61.37a4812d.js"><link rel="prefetch" href="/assets/js/62.5da94048.js"><link rel="prefetch" href="/assets/js/63.8e2c2bca.js"><link rel="prefetch" href="/assets/js/64.d290398f.js"><link rel="prefetch" href="/assets/js/65.44e28313.js"><link rel="prefetch" href="/assets/js/66.9acf0206.js"><link rel="prefetch" href="/assets/js/67.85688aa2.js"><link rel="prefetch" href="/assets/js/68.45bda7fc.js"><link rel="prefetch" href="/assets/js/69.9074feb0.js"><link rel="prefetch" href="/assets/js/7.5d7bce6e.js"><link rel="prefetch" href="/assets/js/70.b4cd2ddc.js"><link rel="prefetch" href="/assets/js/71.53219b13.js"><link rel="prefetch" href="/assets/js/72.af2a7290.js"><link rel="prefetch" href="/assets/js/73.c28fc506.js"><link rel="prefetch" href="/assets/js/75.05191ece.js"><link rel="prefetch" href="/assets/js/76.f516d464.js"><link rel="prefetch" href="/assets/js/77.c345180b.js"><link rel="prefetch" href="/assets/js/78.4a09d0ba.js"><link rel="prefetch" href="/assets/js/79.65f41bcf.js"><link rel="prefetch" href="/assets/js/8.f6cfdc07.js"><link rel="prefetch" href="/assets/js/80.b77151f3.js"><link rel="prefetch" href="/assets/js/81.824fa371.js"><link rel="prefetch" href="/assets/js/82.3f91c09b.js"><link rel="prefetch" href="/assets/js/83.9539f074.js"><link rel="prefetch" href="/assets/js/84.dd89f1de.js"><link rel="prefetch" href="/assets/js/85.15210b99.js"><link rel="prefetch" href="/assets/js/86.e14553e1.js"><link rel="prefetch" href="/assets/js/87.6dc95177.js"><link rel="prefetch" href="/assets/js/88.09c5e890.js"><link rel="prefetch" href="/assets/js/89.0d61f4d0.js"><link rel="prefetch" href="/assets/js/9.759f1986.js"><link rel="prefetch" href="/assets/js/90.a9b14d80.js"><link rel="prefetch" href="/assets/js/91.1a4aabe2.js"><link rel="prefetch" href="/assets/js/92.12070bdb.js"><link rel="prefetch" href="/assets/js/93.b5dc76d0.js"><link rel="prefetch" href="/assets/js/94.690498a6.js"><link rel="prefetch" href="/assets/js/95.b17961e6.js"><link rel="prefetch" href="/assets/js/96.a2f06f3e.js"><link rel="prefetch" href="/assets/js/97.64ef6721.js"><link rel="prefetch" href="/assets/js/98.443eba26.js"><link rel="prefetch" href="/assets/js/99.b6ba7c3a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">MSG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python文档" class="dropdown-title"><span class="title">Python文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="Python文档" class="mobile-dropdown-title"><span class="title">Python文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Python/1.Python-Basics/" class="nav-link router-link-active">
  Python-基础
</a></li><li class="dropdown-item"><!----> <a href="/Python/2. Python-object/" class="nav-link">
  Python-面向对象
</a></li><li class="dropdown-item"><!----> <a href="/Python/3. Python-module/" class="nav-link">
  Python-模块与包
</a></li><li class="dropdown-item"><!----> <a href="/Python/4. Python-network/" class="nav-link">
  Python-网络
</a></li><li class="dropdown-item"><!----> <a href="/Python/5. Python-frontend/" class="nav-link">
  Python-前端
</a></li><li class="dropdown-item"><!----> <a href="/Python/6. Python-MySQL/" class="nav-link">
  Python-数据库
</a></li><li class="dropdown-item"><!----> <a href="/Python/7. Python-Django/" class="nav-link">
  Python-Django
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="容器文档" class="dropdown-title"><span class="title">容器文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="容器文档" class="mobile-dropdown-title"><span class="title">容器文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Container/docker/" class="nav-link">
  docker文檔
</a></li><li class="dropdown-item"><!----> <a href="/Container/Kubernetes/" class="nav-link">
  Kubernetes文檔
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GO文档" class="dropdown-title"><span class="title">GO文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="GO文档" class="mobile-dropdown-title"><span class="title">GO文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/GO/basics/" class="nav-link">
  GO快速入门
</a></li><li class="dropdown-item"><!----> <a href="/GO/module/" class="nav-link">
  GO标准库/GO模块
</a></li></ul></div></div><div class="nav-item"><a href="https://www.linux91.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python文档" class="dropdown-title"><span class="title">Python文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="Python文档" class="mobile-dropdown-title"><span class="title">Python文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Python/1.Python-Basics/" class="nav-link router-link-active">
  Python-基础
</a></li><li class="dropdown-item"><!----> <a href="/Python/2. Python-object/" class="nav-link">
  Python-面向对象
</a></li><li class="dropdown-item"><!----> <a href="/Python/3. Python-module/" class="nav-link">
  Python-模块与包
</a></li><li class="dropdown-item"><!----> <a href="/Python/4. Python-network/" class="nav-link">
  Python-网络
</a></li><li class="dropdown-item"><!----> <a href="/Python/5. Python-frontend/" class="nav-link">
  Python-前端
</a></li><li class="dropdown-item"><!----> <a href="/Python/6. Python-MySQL/" class="nav-link">
  Python-数据库
</a></li><li class="dropdown-item"><!----> <a href="/Python/7. Python-Django/" class="nav-link">
  Python-Django
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="容器文档" class="dropdown-title"><span class="title">容器文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="容器文档" class="mobile-dropdown-title"><span class="title">容器文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Container/docker/" class="nav-link">
  docker文檔
</a></li><li class="dropdown-item"><!----> <a href="/Container/Kubernetes/" class="nav-link">
  Kubernetes文檔
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GO文档" class="dropdown-title"><span class="title">GO文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="GO文档" class="mobile-dropdown-title"><span class="title">GO文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/GO/basics/" class="nav-link">
  GO快速入门
</a></li><li class="dropdown-item"><!----> <a href="/GO/module/" class="nav-link">
  GO标准库/GO模块
</a></li></ul></div></div><div class="nav-item"><a href="https://www.linux91.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Python-基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Python/1.Python-Basics/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/Python/1.Python-Basics/1.初学Python.html" class="sidebar-link">1.初学Python</a></li><li><a href="/Python/1.Python-Basics/2.git的使用.html" class="sidebar-link">2.git的使用</a></li><li><a href="/Python/1.Python-Basics/3.基础Python练习题.html" class="sidebar-link">3.基础Python练习题</a></li><li><a href="/Python/1.Python-Basics/4.int整型类型数据类型.html" class="sidebar-link">4.int整型类型数据类型</a></li><li><a href="/Python/1.Python-Basics/5.bool布尔值数据类型.html" class="sidebar-link">5.bool布尔值数据类型</a></li><li><a href="/Python/1.Python-Basics/6.str字符串数据类型.html" class="sidebar-link">6.str字符串数据类型</a></li><li><a href="/Python/1.Python-Basics/7.list 列表数据类型.html" class="sidebar-link">7.list 列表数据类型</a></li><li><a href="/Python/1.Python-Basics/8.tuple 元组数据类型.html" class="sidebar-link">8.tuple 元组数据类型</a></li><li><a href="/Python/1.Python-Basics/9.range函数.html" class="sidebar-link">9.range函数</a></li><li><a href="/Python/1.Python-Basics/10.dict 字典数据类型.html" class="sidebar-link">10.dict 字典数据类型</a></li><li><a href="/Python/1.Python-Basics/11.解构  解包.html" class="sidebar-link">11.解构  解包</a></li><li><a href="/Python/1.Python-Basics/12.is 跟 == 的区别.html" class="sidebar-link">12.is 跟 == 的区别</a></li><li><a href="/Python/1.Python-Basics/13. 编码跟解码.html" class="sidebar-link">13. 编码跟解码</a></li><li><a href="/Python/1.Python-Basics/14. set集合数据类型.html" class="sidebar-link">14. set集合数据类型</a></li><li><a href="/Python/1.Python-Basics/15. 深浅拷贝.html" class="sidebar-link">15. 深浅拷贝</a></li><li><a href="/Python/1.Python-Basics/16. 文件操作.html" class="sidebar-link">16. 文件操作</a></li><li><a href="/Python/1.Python-Basics/17. 初识函数.html" class="sidebar-link">17. 初识函数</a></li><li><a href="/Python/1.Python-Basics/18. 函数的进阶 .html" class="sidebar-link">18. 函数的进阶</a></li><li><a href="/Python/1.Python-Basics/19. 函数名，闭包，迭代器.html" class="sidebar-link">19. 函数名，闭包，迭代器</a></li><li><a href="/Python/1.Python-Basics/20. 生成器，生成器表达式，推导式.html" class="sidebar-link">20. 生成器，生成器表达式，推导式</a></li><li><a href="/Python/1.Python-Basics/21. 内置函数.html" class="sidebar-link">21. 内置函数</a></li><li><a href="/Python/1.Python-Basics/22. 内置函数进阶.html" class="sidebar-link">22. 内置函数进阶</a></li><li><a href="/Python/1.Python-Basics/23. 装饰器补充.html" class="active sidebar-link">23. 装饰器补充</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#关于函数名" class="sidebar-link">关于函数名</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#做变量" class="sidebar-link">做变量</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#做容器的元素" class="sidebar-link">做容器的元素</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#做参数" class="sidebar-link">做参数</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#做返回值" class="sidebar-link">做返回值</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#灵魂三问" class="sidebar-link">灵魂三问</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#闭包的定义" class="sidebar-link">闭包的定义</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#闭包面试题" class="sidebar-link">闭包面试题</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#装饰器来历" class="sidebar-link">装饰器来历</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#装饰器语法糖" class="sidebar-link">装饰器语法糖</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#装饰器进阶" class="sidebar-link">装饰器进阶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#装饰带返回值的函数" class="sidebar-link">装饰带返回值的函数</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#装饰带参数的函数" class="sidebar-link">装饰带参数的函数</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#带参数的装饰器" class="sidebar-link">带参数的装饰器</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#装饰器修复技术" class="sidebar-link">装饰器修复技术</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#多个装饰器装饰同一函数" class="sidebar-link">多个装饰器装饰同一函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#装饰器终极进阶" class="sidebar-link">装饰器终极进阶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#类装饰器" class="sidebar-link">类装饰器</a></li><li class="sidebar-sub-header"><a href="/Python/1.Python-Basics/23. 装饰器补充.html#装饰类" class="sidebar-link">装饰类</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_23-装饰器补充"><a href="#_23-装饰器补充" class="header-anchor">#</a> 23. 装饰器补充</h1> <h1 id="函数名的运用"><a href="#函数名的运用" class="header-anchor">#</a> 函数名的运用</h1> <h2 id="关于函数名"><a href="#关于函数名" class="header-anchor">#</a> 关于函数名</h2> <p>函数名是⼀个变量，但它是⼀个特殊的变量。与括号配合可以执⾏函数的变量。</p> <p>查看函数名的内存地址:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'呵呵'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>  <span class="token comment"># &lt;function func at 0x10983c048&gt;</span>
</code></pre></div><h2 id="做变量"><a href="#做变量" class="header-anchor">#</a> 做变量</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'呵呵'</span><span class="token punctuation">)</span>


a <span class="token operator">=</span> func  <span class="token comment"># 把函数当成变量赋值给另外一个变量</span>
a<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 通过变量a调用函数</span>
</code></pre></div><h2 id="做容器的元素"><a href="#做容器的元素" class="header-anchor">#</a> 做容器的元素</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'func1'</span><span class="token punctuation">)</span>
    

<span class="token keyword">def</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'func2'</span><span class="token punctuation">)</span>
    
    
<span class="token keyword">def</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'func3'</span><span class="token punctuation">)</span>
    
    
<span class="token keyword">def</span> <span class="token function">func4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'func4'</span><span class="token punctuation">)</span>


list1 <span class="token operator">=</span> <span class="token punctuation">[</span>func1<span class="token punctuation">,</span> func2<span class="token punctuation">,</span> func3<span class="token punctuation">,</span> func4<span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> list1<span class="token punctuation">:</span>
    i<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="做参数"><a href="#做参数" class="header-anchor">#</a> 做参数</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'func1'</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">func2</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>
    arg<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 执行传递进来的arg</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>

func2<span class="token punctuation">(</span>func1<span class="token punctuation">)</span>  <span class="token comment"># 把func1当成参数传递给func2</span>
</code></pre></div><h2 id="做返回值"><a href="#做返回值" class="header-anchor">#</a> 做返回值</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'这里是func1'</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'这里是func2'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> func2  <span class="token comment"># 把func2当成返回值返回</span>


ret <span class="token operator">=</span> func1<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 调用func1，把返回值赋值给ret</span>
ret<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 调用ret</span>
</code></pre></div><h1 id="闭包"><a href="#闭包" class="header-anchor">#</a> 闭包</h1> <h2 id="灵魂三问"><a href="#灵魂三问" class="header-anchor">#</a> 灵魂三问</h2> <p>首先我们来看一个例子：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'张三'</span>

    <span class="token keyword">def</span> <span class="token function">func2</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>
    func2<span class="token punctuation">(</span>name<span class="token punctuation">)</span>

func1<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>理解了上面的例子，我们再看一个例子：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'张三'</span>

    <span class="token keyword">def</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>  <span class="token comment"># 能够访问到外层作用域的变量</span>
    func2<span class="token punctuation">(</span><span class="token punctuation">)</span>

func1<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>最后再看一个例子：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func1</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>  <span class="token comment"># 能够访问到外层作用域的变量</span>
    func2<span class="token punctuation">(</span><span class="token punctuation">)</span>

func1<span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="闭包的定义"><a href="#闭包的定义" class="header-anchor">#</a> 闭包的定义</h2> <p>一个内层函数中，引用了外层函数(非全局)的变量，这个内层函数就可以成为闭包。</p> <p>在Python中，我们可以使用__closure__来检测函数是否是闭包。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'张三'</span>

    <span class="token keyword">def</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>  <span class="token comment"># 能够访问到外层作用域的变量</span>
    func2<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>func2<span class="token punctuation">.</span>__closure__<span class="token punctuation">)</span>  <span class="token comment"># (&lt;cell at 0x1036c7438: str object at 0x10389d088&gt;,)</span>

func1<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>func1<span class="token punctuation">.</span>__closure__<span class="token punctuation">)</span>  <span class="token comment"># None</span>
</code></pre></div><p>问题来了，我们如何在函数外边调用函数内部的函数呢？</p> <p>当然是把内部函数当成返回值返回了。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'张三'</span>

    <span class="token keyword">def</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>

    <span class="token keyword">return</span> func2  <span class="token comment"># 把内部函数当成是返回值返回</span>


ret <span class="token operator">=</span> func1<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 把返回值赋值给变量ret</span>
ret<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 调用内部函数</span>
</code></pre></div><p>内部函数当然还可包含其他的函数，多层嵌套的道理都是一样的。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'func3'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> func3
    <span class="token keyword">return</span> func2


ret1 <span class="token operator">=</span> func1<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># func2</span>
ret2 <span class="token operator">=</span> ret1<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># func3</span>
ret2<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>接下来我们看下面这个例子，来更深刻的理解一下闭包的含义：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">print_msg</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token comment"># 这是外层函数</span>

    <span class="token keyword">def</span> <span class="token function">printer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 这是内层函数</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>

    <span class="token keyword">return</span> printer  <span class="token comment"># 返回内层函数</span>


func <span class="token operator">=</span> print_msg<span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span>
func<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>现在我们进行如下操作：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">del</span> print_msg
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> func<span class="token punctuation">(</span><span class="token punctuation">)</span>
Hello
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> print_msg<span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span>
Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
NameError<span class="token punctuation">:</span> name <span class="token string">'print_msg'</span> <span class="token keyword">is</span> <span class="token keyword">not</span> defined
</code></pre></div><p>我们知道如果⼀个函数执⾏完毕，则这个函数中的变量以及局部命名空间中的内容都将会被销毁。在闭包中内部函数会引用外层函数的变量，而且这个变量将不会随着外层函数的结束而销毁，它会在内存中保留。</p> <p>也就是说，闭包函数可以保留其用到的变量的引用。</p> <h2 id="闭包面试题"><a href="#闭包面试题" class="header-anchor">#</a> 闭包面试题</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 编写代码实现func函数，使其实现以下效果：</span>
foo <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>foo<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 输出64</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>foo<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 输出-8</span>
</code></pre></div><h1 id="装饰器"><a href="#装饰器" class="header-anchor">#</a> 装饰器</h1> <h2 id="装饰器来历"><a href="#装饰器来历" class="header-anchor">#</a> 装饰器来历</h2> <p>在说装饰器之前，我们先说⼀个软件设计的原则: 开闭原则, ⼜被成为开放封闭原则。</p> <p>开放封闭原则是指对扩展代码的功能是开放的，但是对修改源代码是封闭的。这样的软件设计思路可以保证我们更好的开发和维护我们的代码。</p> <p>我们先来写一个例子，模拟一下女娲造人：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">create_people</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'女娲真厉害，捏个泥吹口气就成了人！'</span><span class="token punctuation">)</span>
    

create_people<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>好吧，现在问题来了。上古时期啊，天气很不稳定，这个时候突然大旱三年。女娲再去捏人啊，因为太干了就捏不到一块儿去了，需要在捏人之前洒点水才行。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">create_people</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'洒点水'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'女娲真厉害，捏个泥吹口气就成了人！'</span><span class="token punctuation">)</span>


create_people<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>这不就搞定了么？但是呢，我们是不是违背了开放封闭原则呢？我们是添加了新的功能，但是我们是直接修改了源代码。在软件开发中我们应该对直接修改源代码是谨慎的。</p> <p>比如，女娲为了防止浪费，想用剩下点泥巴捏个鸡、鸭、鹅什么的，也需要洒点水。那我们能在每个造鸡、造鸭、造鹅函数的源代码中都手动添加代码么？肯定是不现实的。</p> <p>怎么办？再写一个函数不就OK了么？</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">create_people</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'女娲真厉害，捏个泥吹口气就成了人！'</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">create_people_with_water</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'洒点水'</span><span class="token punctuation">)</span>
    create_people<span class="token punctuation">(</span><span class="token punctuation">)</span>


create_people_with_water<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>不让我直接修改源代码，那我重新写一个函数不就可以了吗？</p> <p>但是，你有没有想过一个问题，女娲造人也很累的，她后来开了很多分店，每家分店都是调用了之前的create_people函数造人，那么你修改了之后，是不是所有调用原来函数的人都需要修改调用函数的名称呢？很麻烦啊！！！</p> <p>总结一句话就是如何在不改变函数的结构和调用方式的基础上，动态的给函数添加功能？</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">create_people</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'女娲真厉害，捏个泥吹口气就成了人！'</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">a</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'洒点水'</span><span class="token punctuation">)</span>
        func<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> b

ret <span class="token operator">=</span> a<span class="token punctuation">(</span>create_people<span class="token punctuation">)</span>
ret<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>利用闭包函数不就可以了么？</p> <p>但是，你这最后调用的是ret啊，不还是改变了调用方式么？</p> <p>再往下看：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">create_people</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'女娲真厉害，捏个泥吹口气就成了人！'</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">a</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'洒点水'</span><span class="token punctuation">)</span>
        func<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> b

create_people <span class="token operator">=</span> a<span class="token punctuation">(</span>create_people<span class="token punctuation">)</span>
create_people<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>上面这段代码是不是完美解决了我们的问题呢？</p> <p>看一下它的执行过程吧：</p> <ol><li>首先访问a(create_people)</li> <li>把create_people函数赋值给了a函数的形参func，记住后续执行func的话实际上是执行了最开始传入的create_people函数。</li> <li>a函数执行过程就是一句话，返回了b函数。这个时候把b函数赋值给了create_people这个变量</li> <li>执行create_people的时候，相当于执行了b函数，先打印洒点水再执行func，也就是我们最开始传入的create_people函数</li></ol> <p>我们巧妙的使用闭包实现了，把一个函数包装了一下，然后再赋值给原来的函数名。</p> <h2 id="装饰器语法糖"><a href="#装饰器语法糖" class="header-anchor">#</a> 装饰器语法糖</h2> <p>上面的代码就是一个装饰器的雏形，Python中针对于上面的功能提供了一个快捷的写法，俗称装饰器语法糖。</p> <p>使用装饰器语法糖的写法，实现同样功能的代码如下：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">a</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'洒点水'</span><span class="token punctuation">)</span>
        func<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> b


<span class="token decorator annotation punctuation">@a</span>  <span class="token comment"># 装饰器语法糖</span>
<span class="token keyword">def</span> <span class="token function">create_people</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'女娲真厉害，捏个泥吹口气就成了人！'</span><span class="token punctuation">)</span>

create_people<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="装饰器进阶"><a href="#装饰器进阶" class="header-anchor">#</a> 装饰器进阶</h2> <h3 id="装饰带返回值的函数"><a href="#装饰带返回值的函数" class="header-anchor">#</a> 装饰带返回值的函数</h3> <p>如果被装饰的函数有返回值，我们应该怎么处理呢？</p> <p>请看下面的示例：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">foo</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 接收的参数是一个函数名</span>
    <span class="token keyword">def</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 定义一个内层函数</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;这里是新功能...&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 新功能</span>
        r <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 在内存函数中拿到被装饰函数的结果</span>
        <span class="token keyword">return</span> r  <span class="token comment"># 返回被装饰函数的执行结果</span>
    <span class="token keyword">return</span> bar


<span class="token comment"># 定义一个有返回值的函数</span>
<span class="token decorator annotation punctuation">@foo</span>
<span class="token keyword">def</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'嘿嘿嘿'</span>


<span class="token comment"># 调用被装饰函数</span>
ret <span class="token operator">=</span> f1<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 调用被装饰函数并拿到结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
</code></pre></div><h3 id="装饰带参数的函数"><a href="#装饰带参数的函数" class="header-anchor">#</a> 装饰带参数的函数</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">foo</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 接收的参数是一个函数名</span>
    <span class="token keyword">def</span> <span class="token function">bar</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 这里需要定义和被装饰函数相同的参数</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;这里是新功能...&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 新功能</span>
        func<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>  <span class="token comment"># 被装饰函数名和参数都有了，就能执行被装饰函数了</span>
    <span class="token keyword">return</span> bar


<span class="token comment"># 定义一个需要两个参数的函数</span>
<span class="token decorator annotation punctuation">@foo</span>
<span class="token keyword">def</span> <span class="token function">f1</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{}+{}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># 调用被装饰函数</span>
f1<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="带参数的装饰器"><a href="#带参数的装饰器" class="header-anchor">#</a> 带参数的装饰器</h3> <p>被装饰的函数可以带参数，装饰器同样也可以带参数。</p> <p>回头看我们上面写得那些装饰器，它们默认把被装饰的函数当成唯一的参数。但是呢，有时候我们需要为我们的装饰器传递参数，这种情况下应该怎么办呢？</p> <p>接下来，我们就一步步实现带参数的装饰器：</p> <p>首先我们来回顾下上面的代码：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">f1</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># f1是我们定义的装饰器函数，func是被装饰的函数</span>
    <span class="token keyword">def</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token operator">*</span>arg<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># *args和**kwargs是被装饰函数的参数</span>
        func<span class="token punctuation">(</span><span class="token operator">*</span>arg<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token keyword">return</span> f2
</code></pre></div><p>从上面的代码，我们发现了什么？</p> <p>我的装饰器如果有参数的话，没地方写了…怎么办呢？</p> <p>还是要使用闭包函数！</p> <p>我们需要知道，函数除了可以嵌套两层，还能嵌套更多层：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 三层嵌套的函数</span>
<span class="token keyword">def</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    
    <span class="token keyword">def</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        name <span class="token operator">=</span> <span class="token string">&quot;张三&quot;</span>       
        <span class="token keyword">def</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        <span class="token keyword">return</span> f3    
    <span class="token keyword">return</span> f2
</code></pre></div><p>嵌套三层之后的函数调用：</p> <div class="language-python extra-class"><pre class="language-python"><code>f <span class="token operator">=</span> f1<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># f --&gt; f2</span>
ff <span class="token operator">=</span> f<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ff --&gt; f3</span>
ff<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ff()  --&gt; f3()  --&gt; print(name)  --&gt; 张三</span>
</code></pre></div><p>注意：在内部函数f3中能够访问到它外层函数f2中定义的变量，当然也可以访问到它最外层函数f1中定义的变量。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 三层嵌套的函数2</span>
<span class="token keyword">def</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'张三'</span>
    <span class="token keyword">def</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        <span class="token keyword">return</span> f3
    <span class="token keyword">return</span> f2
</code></pre></div><p>调用:</p> <div class="language-python extra-class"><pre class="language-python"><code>f <span class="token operator">=</span> f1<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># f --&gt; f2</span>
ff <span class="token operator">=</span> f<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ff --&gt; f3</span>
ff<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ff()  --&gt; f3()  --&gt; print(name)  --&gt; 张三</span>
</code></pre></div><p>好了，现在我们就可以实现我们的带参数的装饰器函数了：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 带参数的装饰器需要定义一个三层的嵌套函数</span>
<span class="token keyword">def</span> <span class="token function">d</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># d是新添加的最外层函数，为我们原来的装饰器传递参数，name就是我们要传递的函数</span>
    <span class="token keyword">def</span> <span class="token function">f1</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># f1是我们原来的装饰器函数，func是被装饰的函数</span>
        <span class="token keyword">def</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token operator">*</span>arg<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># f2是内部函数，*args和**kwargs是被装饰函数的参数</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>  <span class="token comment"># 使用装饰器函数的参数</span>
            func<span class="token punctuation">(</span><span class="token operator">*</span>arg<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>  <span class="token comment"># 调用被装饰的函数</span>
        <span class="token keyword">return</span> f2
    <span class="token keyword">return</span> f1
</code></pre></div><p>上面就是一个带参装饰器的代码示例，现在我们来写一个完整的应用：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">d</span><span class="token punctuation">(</span>a<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 定义一个外层函数，给装饰器传参数--role</span>
    <span class="token keyword">def</span> <span class="token function">foo</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># foo是我们原来的装饰器函数，func是被装饰的函数</span>
        <span class="token keyword">def</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># args和kwargs是被装饰器函数的参数</span>
            <span class="token comment"># 根据装饰器的参数做一些逻辑判断</span>
            <span class="token keyword">if</span> a<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;欢迎来到{}页面。&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;欢迎来到首页。&quot;</span><span class="token punctuation">)</span>
            <span class="token comment"># 调用被装饰的函数，接收参数args和kwargs</span>
            func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">return</span> bar
    <span class="token keyword">return</span> foo


<span class="token decorator annotation punctuation">@d</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 不给装饰器传参数，使用默认的'None'参数</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello {}.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@d</span><span class="token punctuation">(</span><span class="token string">&quot;电影&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 给装饰器传一个'电影'参数</span>
<span class="token keyword">def</span> <span class="token function">movie</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello {}.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    index<span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">)</span>
    movie<span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="装饰器修复技术"><a href="#装饰器修复技术" class="header-anchor">#</a> 装饰器修复技术</h3> <p>被装饰的函数最终都会失去本来的__doc__等信息， Python给我们提供了一个修复被装饰函数的工具。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">a</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'洒点水'</span><span class="token punctuation">)</span>
        func<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> b


<span class="token decorator annotation punctuation">@a</span>  <span class="token comment"># 装饰器语法糖</span>
<span class="token keyword">def</span> <span class="token function">create_people</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;这是一个女娲造人的功能函数&quot;&quot;&quot;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'女娲真厉害，捏个泥吹口气就成了人！'</span><span class="token punctuation">)</span>

create_people<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>create_people<span class="token punctuation">.</span>__doc__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>create_people<span class="token punctuation">.</span>__name__<span class="token punctuation">)</span>
</code></pre></div><h3 id="多个装饰器装饰同一函数"><a href="#多个装饰器装饰同一函数" class="header-anchor">#</a> 多个装饰器装饰同一函数</h3> <p>同一个函数可以被多个装饰器装饰，此时需要注意装饰器的执行顺序。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">foo1</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;d1&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">inner1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;inner1&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&lt;i&gt;{}&lt;/i&gt;&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>func<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> inner1


<span class="token keyword">def</span> <span class="token function">foo2</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;d2&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">inner2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;inner2&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&lt;b&gt;{}&lt;/b&gt;&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>func<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> inner2


<span class="token decorator annotation punctuation">@foo1</span>
<span class="token decorator annotation punctuation">@foo2</span>
<span class="token keyword">def</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello Andy&quot;</span>

<span class="token comment"># f1 = foo2(f1)  ==&gt; print(&quot;d2&quot;) ==&gt; f1 = inner2</span>
<span class="token comment"># f1 = foo1(f1)  ==&gt; print(&quot;d1&quot;) ==&gt; f1 = foo1(inner2) ==&gt; inner1</span>

ret <span class="token operator">=</span> f1<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 调用f1() ==&gt; inner1()  ==&gt; &lt;i&gt;inner2()&lt;/i&gt;  ==&gt; &lt;i&gt;&lt;b&gt;inner1()&lt;/b&gt;&lt;/i&gt; ==&gt; &lt;i&gt;&lt;b&gt;Hello Andy&lt;/b&gt;&lt;/i&gt;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
</code></pre></div><h2 id="装饰器终极进阶"><a href="#装饰器终极进阶" class="header-anchor">#</a> 装饰器终极进阶</h2> <h3 id="类装饰器"><a href="#类装饰器" class="header-anchor">#</a> 类装饰器</h3> <p>我们除了可以使用函数装饰函数外，还可以用类装饰函数。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">D</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
        self<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;装饰&quot;</span>

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">&quot;装饰&quot;</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>func <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 默认第一个参数是被装饰的函数</span>
            self<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;调用&quot;</span>
            <span class="token keyword">return</span> self
        <span class="token comment"># 当self.mode == &quot;调用&quot;时，执行下面的代码（也就是调用使用类装饰的函数时执行）</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>a<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;欢迎来到{}页面。&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;欢迎来到首页。&quot;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@D</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello {}.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@D</span><span class="token punctuation">(</span><span class="token string">&quot;电影&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">movie</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello {}.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    index<span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">)</span>
    movie<span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="装饰类"><a href="#装饰类" class="header-anchor">#</a> 装饰类</h3> <p>我们上面所有的例子都是装饰一个函数，返回一个可执行函数。Python中的装饰器除了能装饰函数外，还能装饰类。</p> <p>可以使用装饰器，来批量修改被装饰类的某些方法：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 定义一个类装饰器</span>
<span class="token keyword">class</span> <span class="token class-name">D</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">class</span> <span class="token class-name">Inner</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 重写被装饰类的f方法</span>
            <span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Hello 张三.'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Inner


<span class="token decorator annotation punctuation">@D</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 被装饰的类</span>
    <span class="token comment"># 有一个实例方法</span>
    <span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world.&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    c <span class="token operator">=</span> C<span class="token punctuation">(</span><span class="token punctuation">)</span>
    c<span class="token punctuation">.</span>f<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>举个实际的应用示例：</p> <p>我们把类中的一个只读属性定义为property属性方法，只有在访问它时才参与计算，一旦访问了该属性，我们就把这个值缓存起来，下次再访问的时候无需重新计算。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">lazyproperty</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> func<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>func <span class="token operator">=</span> func

    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> owner<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> instance <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            value <span class="token operator">=</span> self<span class="token punctuation">.</span>func<span class="token punctuation">(</span>instance<span class="token punctuation">)</span>
            <span class="token builtin">setattr</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> self<span class="token punctuation">.</span>func<span class="token punctuation">.</span>__name__<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
            <span class="token keyword">return</span> value


<span class="token keyword">import</span> math


<span class="token keyword">class</span> <span class="token class-name">Circle</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> radius<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>radius <span class="token operator">=</span> radius

    <span class="token decorator annotation punctuation">@lazyproperty</span>
    <span class="token keyword">def</span> <span class="token function">area</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'计算面积'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> math<span class="token punctuation">.</span>pi <span class="token operator">*</span> self<span class="token punctuation">.</span>radius <span class="token operator">**</span> <span class="token number">2</span>


c1 <span class="token operator">=</span> Circle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c1<span class="token punctuation">.</span>area<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c1<span class="token punctuation">.</span>area<span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Python/1.Python-Basics/22. 内置函数进阶.html" class="prev">
        22. 内置函数进阶
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d65bef42.js" defer></script><script src="/assets/js/2.2249178e.js" defer></script><script src="/assets/js/74.64c81a90.js" defer></script>
  </body>
</html>
