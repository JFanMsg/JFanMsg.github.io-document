<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>77. Django视图、request方法大全 | MSG</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="在追寻技术的同时享受生活">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.d65bef42.js" as="script"><link rel="preload" href="/assets/js/2.2249178e.js" as="script"><link rel="preload" href="/assets/js/150.5bf39cb4.js" as="script"><link rel="prefetch" href="/assets/js/10.4785e2e5.js"><link rel="prefetch" href="/assets/js/100.33fceff2.js"><link rel="prefetch" href="/assets/js/101.62e1e5d4.js"><link rel="prefetch" href="/assets/js/102.8551fe71.js"><link rel="prefetch" href="/assets/js/103.47754d79.js"><link rel="prefetch" href="/assets/js/104.4adf114f.js"><link rel="prefetch" href="/assets/js/105.6206a08a.js"><link rel="prefetch" href="/assets/js/106.1c4561f3.js"><link rel="prefetch" href="/assets/js/107.e1531a5a.js"><link rel="prefetch" href="/assets/js/108.c637743a.js"><link rel="prefetch" href="/assets/js/109.3f150913.js"><link rel="prefetch" href="/assets/js/11.bd8ec7a6.js"><link rel="prefetch" href="/assets/js/110.088c1ac3.js"><link rel="prefetch" href="/assets/js/111.66d8d491.js"><link rel="prefetch" href="/assets/js/112.231663ee.js"><link rel="prefetch" href="/assets/js/113.a38bc531.js"><link rel="prefetch" href="/assets/js/114.e165daea.js"><link rel="prefetch" href="/assets/js/115.994b087a.js"><link rel="prefetch" href="/assets/js/116.ea3cfdfb.js"><link rel="prefetch" href="/assets/js/117.7be5e4f3.js"><link rel="prefetch" href="/assets/js/118.ebb58ddb.js"><link rel="prefetch" href="/assets/js/119.90018646.js"><link rel="prefetch" href="/assets/js/12.0d8f43df.js"><link rel="prefetch" href="/assets/js/120.bb5be863.js"><link rel="prefetch" href="/assets/js/121.3d1db670.js"><link rel="prefetch" href="/assets/js/122.d29ed1b2.js"><link rel="prefetch" href="/assets/js/123.38cc4704.js"><link rel="prefetch" href="/assets/js/124.cc8549d4.js"><link rel="prefetch" href="/assets/js/125.6ee3e9c8.js"><link rel="prefetch" href="/assets/js/126.48710eba.js"><link rel="prefetch" href="/assets/js/127.d7a1fd83.js"><link rel="prefetch" href="/assets/js/128.e5017f6b.js"><link rel="prefetch" href="/assets/js/129.4c33e121.js"><link rel="prefetch" href="/assets/js/13.2dbde7aa.js"><link rel="prefetch" href="/assets/js/130.cda66247.js"><link rel="prefetch" href="/assets/js/131.ad76f669.js"><link rel="prefetch" href="/assets/js/132.aca88758.js"><link rel="prefetch" href="/assets/js/133.a1cf5903.js"><link rel="prefetch" href="/assets/js/134.b1386377.js"><link rel="prefetch" href="/assets/js/135.94edcf53.js"><link rel="prefetch" href="/assets/js/136.24be4170.js"><link rel="prefetch" href="/assets/js/137.db57772e.js"><link rel="prefetch" href="/assets/js/138.dc67bcaa.js"><link rel="prefetch" href="/assets/js/139.5453d1f6.js"><link rel="prefetch" href="/assets/js/14.2187dbf4.js"><link rel="prefetch" href="/assets/js/140.938e5c07.js"><link rel="prefetch" href="/assets/js/141.99c7cf2c.js"><link rel="prefetch" href="/assets/js/142.428e3958.js"><link rel="prefetch" href="/assets/js/143.68b01530.js"><link rel="prefetch" href="/assets/js/144.f67389cc.js"><link rel="prefetch" href="/assets/js/145.d952a130.js"><link rel="prefetch" href="/assets/js/146.b933dcad.js"><link rel="prefetch" href="/assets/js/147.2d8e4c0a.js"><link rel="prefetch" href="/assets/js/148.6d76ac94.js"><link rel="prefetch" href="/assets/js/149.6b4d6378.js"><link rel="prefetch" href="/assets/js/15.a53b356c.js"><link rel="prefetch" href="/assets/js/151.17af677c.js"><link rel="prefetch" href="/assets/js/152.7f1c2792.js"><link rel="prefetch" href="/assets/js/153.98dd0727.js"><link rel="prefetch" href="/assets/js/154.eb44bf23.js"><link rel="prefetch" href="/assets/js/155.5a9840ea.js"><link rel="prefetch" href="/assets/js/156.7ba01fd0.js"><link rel="prefetch" href="/assets/js/157.2296a048.js"><link rel="prefetch" href="/assets/js/158.6bb1f699.js"><link rel="prefetch" href="/assets/js/159.073bb8df.js"><link rel="prefetch" href="/assets/js/16.cef7bf44.js"><link rel="prefetch" href="/assets/js/160.25a837f9.js"><link rel="prefetch" href="/assets/js/161.93d886a1.js"><link rel="prefetch" href="/assets/js/162.5d2714b2.js"><link rel="prefetch" href="/assets/js/17.96f36904.js"><link rel="prefetch" href="/assets/js/18.fd04b310.js"><link rel="prefetch" href="/assets/js/19.3e1377d1.js"><link rel="prefetch" href="/assets/js/20.ac195ac8.js"><link rel="prefetch" href="/assets/js/21.c2d7729c.js"><link rel="prefetch" href="/assets/js/22.dd8c621b.js"><link rel="prefetch" href="/assets/js/23.ad7d0350.js"><link rel="prefetch" href="/assets/js/24.8559c4c3.js"><link rel="prefetch" href="/assets/js/25.783a8116.js"><link rel="prefetch" href="/assets/js/26.25e0e459.js"><link rel="prefetch" href="/assets/js/27.c0616e2a.js"><link rel="prefetch" href="/assets/js/28.30656c2e.js"><link rel="prefetch" href="/assets/js/29.2be5114c.js"><link rel="prefetch" href="/assets/js/3.be8c8f3b.js"><link rel="prefetch" href="/assets/js/30.230a74a7.js"><link rel="prefetch" href="/assets/js/31.760f46ad.js"><link rel="prefetch" href="/assets/js/32.c9533fef.js"><link rel="prefetch" href="/assets/js/33.dcacfb38.js"><link rel="prefetch" href="/assets/js/34.4370a466.js"><link rel="prefetch" href="/assets/js/35.bf299eea.js"><link rel="prefetch" href="/assets/js/36.336e435a.js"><link rel="prefetch" href="/assets/js/37.1d1d2eea.js"><link rel="prefetch" href="/assets/js/38.0d58b7d0.js"><link rel="prefetch" href="/assets/js/39.d43564ba.js"><link rel="prefetch" href="/assets/js/4.4a6cb970.js"><link rel="prefetch" href="/assets/js/40.bc4e4bde.js"><link rel="prefetch" href="/assets/js/41.b71231a5.js"><link rel="prefetch" href="/assets/js/42.9d46f400.js"><link rel="prefetch" href="/assets/js/43.50c5be69.js"><link rel="prefetch" href="/assets/js/44.60406e7f.js"><link rel="prefetch" href="/assets/js/45.ec3569ae.js"><link rel="prefetch" href="/assets/js/46.1bd3ce7b.js"><link rel="prefetch" href="/assets/js/47.1e1b5326.js"><link rel="prefetch" href="/assets/js/48.64c631ea.js"><link rel="prefetch" href="/assets/js/49.b4abacd8.js"><link rel="prefetch" href="/assets/js/5.e6d0b165.js"><link rel="prefetch" href="/assets/js/50.c3e320c0.js"><link rel="prefetch" href="/assets/js/51.5ec7fb8c.js"><link rel="prefetch" href="/assets/js/52.2d234f86.js"><link rel="prefetch" href="/assets/js/53.f3b69623.js"><link rel="prefetch" href="/assets/js/54.c85ff450.js"><link rel="prefetch" href="/assets/js/55.b07597b5.js"><link rel="prefetch" href="/assets/js/56.444129cf.js"><link rel="prefetch" href="/assets/js/57.df1329ba.js"><link rel="prefetch" href="/assets/js/58.5afb51cf.js"><link rel="prefetch" href="/assets/js/59.d98936d9.js"><link rel="prefetch" href="/assets/js/6.809376cd.js"><link rel="prefetch" href="/assets/js/60.02813ecf.js"><link rel="prefetch" href="/assets/js/61.37a4812d.js"><link rel="prefetch" href="/assets/js/62.5da94048.js"><link rel="prefetch" href="/assets/js/63.8e2c2bca.js"><link rel="prefetch" href="/assets/js/64.d290398f.js"><link rel="prefetch" href="/assets/js/65.44e28313.js"><link rel="prefetch" href="/assets/js/66.9acf0206.js"><link rel="prefetch" href="/assets/js/67.85688aa2.js"><link rel="prefetch" href="/assets/js/68.45bda7fc.js"><link rel="prefetch" href="/assets/js/69.9074feb0.js"><link rel="prefetch" href="/assets/js/7.5d7bce6e.js"><link rel="prefetch" href="/assets/js/70.b4cd2ddc.js"><link rel="prefetch" href="/assets/js/71.53219b13.js"><link rel="prefetch" href="/assets/js/72.af2a7290.js"><link rel="prefetch" href="/assets/js/73.c28fc506.js"><link rel="prefetch" href="/assets/js/74.64c81a90.js"><link rel="prefetch" href="/assets/js/75.05191ece.js"><link rel="prefetch" href="/assets/js/76.f516d464.js"><link rel="prefetch" href="/assets/js/77.c345180b.js"><link rel="prefetch" href="/assets/js/78.4a09d0ba.js"><link rel="prefetch" href="/assets/js/79.65f41bcf.js"><link rel="prefetch" href="/assets/js/8.f6cfdc07.js"><link rel="prefetch" href="/assets/js/80.b77151f3.js"><link rel="prefetch" href="/assets/js/81.824fa371.js"><link rel="prefetch" href="/assets/js/82.3f91c09b.js"><link rel="prefetch" href="/assets/js/83.9539f074.js"><link rel="prefetch" href="/assets/js/84.dd89f1de.js"><link rel="prefetch" href="/assets/js/85.15210b99.js"><link rel="prefetch" href="/assets/js/86.e14553e1.js"><link rel="prefetch" href="/assets/js/87.6dc95177.js"><link rel="prefetch" href="/assets/js/88.09c5e890.js"><link rel="prefetch" href="/assets/js/89.0d61f4d0.js"><link rel="prefetch" href="/assets/js/9.759f1986.js"><link rel="prefetch" href="/assets/js/90.a9b14d80.js"><link rel="prefetch" href="/assets/js/91.1a4aabe2.js"><link rel="prefetch" href="/assets/js/92.12070bdb.js"><link rel="prefetch" href="/assets/js/93.b5dc76d0.js"><link rel="prefetch" href="/assets/js/94.690498a6.js"><link rel="prefetch" href="/assets/js/95.b17961e6.js"><link rel="prefetch" href="/assets/js/96.a2f06f3e.js"><link rel="prefetch" href="/assets/js/97.64ef6721.js"><link rel="prefetch" href="/assets/js/98.443eba26.js"><link rel="prefetch" href="/assets/js/99.b6ba7c3a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">MSG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python文档" class="dropdown-title"><span class="title">Python文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="Python文档" class="mobile-dropdown-title"><span class="title">Python文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Python/1.Python-Basics/" class="nav-link">
  Python-基础
</a></li><li class="dropdown-item"><!----> <a href="/Python/2. Python-object/" class="nav-link">
  Python-面向对象
</a></li><li class="dropdown-item"><!----> <a href="/Python/3. Python-module/" class="nav-link">
  Python-模块与包
</a></li><li class="dropdown-item"><!----> <a href="/Python/4. Python-network/" class="nav-link">
  Python-网络
</a></li><li class="dropdown-item"><!----> <a href="/Python/5. Python-frontend/" class="nav-link">
  Python-前端
</a></li><li class="dropdown-item"><!----> <a href="/Python/6. Python-MySQL/" class="nav-link">
  Python-数据库
</a></li><li class="dropdown-item"><!----> <a href="/Python/7. Python-Django/" class="nav-link">
  Python-Django
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="容器文档" class="dropdown-title"><span class="title">容器文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="容器文档" class="mobile-dropdown-title"><span class="title">容器文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Container/docker/" class="nav-link">
  docker文檔
</a></li><li class="dropdown-item"><!----> <a href="/Container/Kubernetes/" class="nav-link">
  Kubernetes文檔
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GO文档" class="dropdown-title"><span class="title">GO文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="GO文档" class="mobile-dropdown-title"><span class="title">GO文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/GO/basics/" class="nav-link">
  GO快速入门
</a></li><li class="dropdown-item"><!----> <a href="/GO/module/" class="nav-link">
  GO标准库/GO模块
</a></li></ul></div></div><div class="nav-item"><a href="https://www.linux91.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python文档" class="dropdown-title"><span class="title">Python文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="Python文档" class="mobile-dropdown-title"><span class="title">Python文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Python/1.Python-Basics/" class="nav-link">
  Python-基础
</a></li><li class="dropdown-item"><!----> <a href="/Python/2. Python-object/" class="nav-link">
  Python-面向对象
</a></li><li class="dropdown-item"><!----> <a href="/Python/3. Python-module/" class="nav-link">
  Python-模块与包
</a></li><li class="dropdown-item"><!----> <a href="/Python/4. Python-network/" class="nav-link">
  Python-网络
</a></li><li class="dropdown-item"><!----> <a href="/Python/5. Python-frontend/" class="nav-link">
  Python-前端
</a></li><li class="dropdown-item"><!----> <a href="/Python/6. Python-MySQL/" class="nav-link">
  Python-数据库
</a></li><li class="dropdown-item"><!----> <a href="/Python/7. Python-Django/" class="nav-link">
  Python-Django
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="容器文档" class="dropdown-title"><span class="title">容器文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="容器文档" class="mobile-dropdown-title"><span class="title">容器文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Container/docker/" class="nav-link">
  docker文檔
</a></li><li class="dropdown-item"><!----> <a href="/Container/Kubernetes/" class="nav-link">
  Kubernetes文檔
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GO文档" class="dropdown-title"><span class="title">GO文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="GO文档" class="mobile-dropdown-title"><span class="title">GO文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/GO/basics/" class="nav-link">
  GO快速入门
</a></li><li class="dropdown-item"><!----> <a href="/GO/module/" class="nav-link">
  GO标准库/GO模块
</a></li></ul></div></div><div class="nav-item"><a href="https://www.linux91.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Python-Django</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Python/7.%20Python-Django/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/Python/7. Python-Django/68. request相关的属性.html" class="sidebar-link">68. request相关的属性</a></li><li><a href="/Python/7. Python-Django/69. WEB框架的本质.html" class="sidebar-link">69. WEB框架的本质</a></li><li><a href="/Python/7. Python-Django/70. Django框架、基础.html" class="sidebar-link">70. Django框架、基础</a></li><li><a href="/Python/7. Python-Django/71. Django图书馆之出版社的增删改查 - 单表.html" class="sidebar-link">71. Django图书馆之出版社的增删改查 - 单表</a></li><li><a href="/Python/7. Python-Django/72. Django图书馆之书籍的增删改查 - 多表(外键).html" class="sidebar-link">72. Django图书馆之书籍的增删改查 - 多表(外键)</a></li><li><a href="/Python/7. Python-Django/73. Django图书馆之作者的增删改查 - 多对多关系表.html" class="sidebar-link">73. Django图书馆之作者的增删改查 - 多对多关系表</a></li><li><a href="/Python/7. Python-Django/74. Django简单上传文件.html" class="sidebar-link">74. Django简单上传文件</a></li><li><a href="/Python/7. Python-Django/75. Django模板语言之变量.html" class="sidebar-link">75. Django模板语言之变量</a></li><li><a href="/Python/7. Python-Django/76. Django模板语言之逻辑.html" class="sidebar-link">76. Django模板语言之逻辑</a></li><li><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html" class="active sidebar-link">77. Django视图、request方法大全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#简单视图" class="sidebar-link">简单视图</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#cbv和fbv" class="sidebar-link">CBV和FBV</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#fbv版" class="sidebar-link">FBV版：</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#cbv版" class="sidebar-link">CBV版：</a></li></ul></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#给视图加装饰器" class="sidebar-link">给视图加装饰器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#使用装饰器装饰fbv" class="sidebar-link">使用装饰器装饰FBV</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#使用装饰器装饰cbv" class="sidebar-link">使用装饰器装饰CBV</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#关于cbv的扩展阅读" class="sidebar-link">关于CBV的扩展阅读</a></li></ul></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#请求相关的常用值" class="sidebar-link">请求相关的常用值</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#属性" class="sidebar-link">属性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#scheme-显示请求方案的字符串" class="sidebar-link">scheme - 显示请求方案的字符串</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#body-代表请求报文的主体" class="sidebar-link">body - 代表请求报文的主体</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#path-表示请求的路径" class="sidebar-link">path - 表示请求的路径</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#method-表示请求使用的http" class="sidebar-link">method - 表示请求使用的HTTP</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#encoding-表示提交的数据的编码方式" class="sidebar-link">encoding - 表示提交的数据的编码方式</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#get-请求类型数据" class="sidebar-link">GET - 请求类型数据</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#post-请求类型数据" class="sidebar-link">POST - 请求类型数据</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#cookies-包含所有的cookie" class="sidebar-link">COOKIES - 包含所有的cookie</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#files-包含所有的上传文件信息" class="sidebar-link">FILES - 包含所有的上传文件信息</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#meta-包含所有的http-首部" class="sidebar-link">META - 包含所有的HTTP 首部</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#user-表示当前登录的用户" class="sidebar-link">user - 表示当前登录的用户</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#session-表示当前的会话" class="sidebar-link">session - 表示当前的会话</a></li></ul></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#上传文件示例" class="sidebar-link">上传文件示例</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#方法大全" class="sidebar-link">方法大全</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#属性-2" class="sidebar-link">属性</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#render" class="sidebar-link">render()</a></li><li class="sidebar-sub-header"><a href="/Python/7. Python-Django/77. Django视图、request方法大全.html#redirect" class="sidebar-link">redirect()</a></li></ul></li><li><a href="/Python/7. Python-Django/78. Django路由系统(url).html" class="sidebar-link">78. Django路由系统(url)</a></li><li><a href="/Python/7. Python-Django/79. Django模型(ORM) 认识、字段.html" class="sidebar-link">79. Django模型(ORM) 认识、字段</a></li><li><a href="/Python/7. Python-Django/80. Django模型(ORM) 操作、进阶.html" class="sidebar-link">80. Django模型(ORM) 操作、进阶</a></li><li><a href="/Python/7. Python-Django/81. Django - Cookie、Session、自定义分页.html" class="sidebar-link">81. Django - Cookie、Session、自定义分页</a></li><li><a href="/Python/7. Python-Django/82. Django - 中间件.html" class="sidebar-link">82. Django - 中间件</a></li><li><a href="/Python/7. Python-Django/83. Django - ajax、csrf中间件补充.html" class="sidebar-link">83. Django - ajax、csrf中间件补充</a></li><li><a href="/Python/7. Python-Django/84. Django - Form、ModelForm.html" class="sidebar-link">84. Django - Form、ModelForm</a></li><li><a href="/Python/7. Python-Django/85. Django - auth认证组件.html" class="sidebar-link">85. Django - auth认证组件</a></li><li><a href="/Python/7. Python-Django/86. 权限控制.html" class="sidebar-link">86. 权限控制</a></li><li><a href="/Python/7. Python-Django/87. django小技巧.html" class="sidebar-link">87. django小技巧</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_77-django视图、request方法大全"><a href="#_77-django视图、request方法大全" class="header-anchor">#</a> 77. Django视图、request方法大全</h1> <h1 id="django的view-视图"><a href="#django的view-视图" class="header-anchor">#</a> Django的View（视图）</h1> <p>一个视图函数（类），简称视图，是一个简单的Python 函数（类），它接受Web请求并且返回Web响应。</p> <p>响应可以是一张网页的HTML内容，一个重定向，一个404错误，一个XML文档，或者一张图片。</p> <p>无论视图本身包含什么逻辑，都要返回响应。代码写在哪里也无所谓，只要它在你当前项目目录下面。</p> <p>除此之外没有更多的要求了——可以说“没有什么神奇的地方”。</p> <p>为了将代码放在某处，大家约定成俗将视图放置在项目（project）或应用程序（app）目录中的名为 views.py 的文件中。</p> <h2 id="简单视图"><a href="#简单视图" class="header-anchor">#</a> <strong>简单视图</strong></h2> <p>下面是一个以HTML文档的形式返回当前日期和时间的视图：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse
<span class="token keyword">import</span> datetime

<span class="token keyword">def</span> <span class="token function">current_datetime</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    html <span class="token operator">=</span> <span class="token string">&quot;&lt;html&gt;&lt;body&gt;It is now %s.&lt;/body&gt;&lt;/html&gt;&quot;</span> <span class="token operator">%</span> now
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>html<span class="token punctuation">)</span>
</code></pre></div><p>让我们来逐行解释下上面的代码：</p> <ol><li>首先，我们从 <code>django.http</code>模块导入了<code>HttpResponse</code>类，以及Python的<code>datetime</code>库。</li> <li>接着，我们定义了<code>current_datetime</code>函数。它就是视图函数。</li> <li>每个视图函数都使用<code>HttpRequest</code>对象作为第一个参数，并且通常称之为<code>request</code>。</li></ol> <p>注意，视图函数的名称并不重要，不需要用一个统一的命名方式来命名，以便让Django识别它。我们将其命名为<code>current_datetime</code>，是因为这个名称能够比较准确地反映出它实现的功能。</p> <ol><li>这个视图会返回一个<code>HttpResponse</code>对象，其中包含生成的响应。</li> <li>每个视图函数都负责返回一个<code>HttpResponse</code>对象。</li></ol> <p>Django使用请求和响应对象来通过系统传递状态。</p> <ol><li>当浏览器向服务端请求一个页面时，Django创建一个HttpRequest对象，该对象包含关于请求的元数据。</li> <li>然后，Django加载相应的视图，将这个HttpRequest对象作为第一个参数传递给视图函数。</li> <li>每个视图负责返回一个HttpResponse对象。</li></ol> <h2 id="cbv和fbv"><a href="#cbv和fbv" class="header-anchor">#</a> <strong>CBV和FBV</strong></h2> <p>我们之前写过的都是基于函数的view，就叫FBV。还可以把view写成基于类的。</p> <p>就拿我们之前写过的添加班级为例：</p> <h3 id="fbv版"><a href="#fbv版" class="header-anchor">#</a> FBV版：</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># FBV版添加班级</span>
<span class="token keyword">def</span> <span class="token function">add_class</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">:</span>
        class_name <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;class_name&quot;</span><span class="token punctuation">)</span>
        models<span class="token punctuation">.</span>Classes<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>name<span class="token operator">=</span>class_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">&quot;/class_list/&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;add_class.html&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="cbv版"><a href="#cbv版" class="header-anchor">#</a> CBV版：</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># CBV版添加班级</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>views <span class="token keyword">import</span> View


<span class="token keyword">class</span> <span class="token class-name">AddClass</span><span class="token punctuation">(</span>View<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;add_class.html&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        class_name <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;class_name&quot;</span><span class="token punctuation">)</span>
        models<span class="token punctuation">.</span>Classes<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>name<span class="token operator">=</span>class_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">&quot;/class_list/&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>注意：</strong></p> <p>使用CBV时，urls.py中也做对应的修改：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># urls.py中</span>
url<span class="token punctuation">(</span><span class="token string">r'^add_class/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>AddClass<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="给视图加装饰器"><a href="#给视图加装饰器" class="header-anchor">#</a> <strong>给视图加装饰器</strong></h2> <h3 id="使用装饰器装饰fbv"><a href="#使用装饰器装饰fbv" class="header-anchor">#</a> 使用装饰器装饰FBV</h3> <p>FBV本身就是一个函数，所以和给普通的函数加装饰器无差：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">inner</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ret <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;used:&quot;</span><span class="token punctuation">,</span> end_time<span class="token operator">-</span>start_time<span class="token punctuation">)</span>
        <span class="token keyword">return</span> ret
    <span class="token keyword">return</span> inner


<span class="token comment"># FBV版添加班级</span>
<span class="token decorator annotation punctuation">@wrapper</span>
<span class="token keyword">def</span> <span class="token function">add_class</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">:</span>
        class_name <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;class_name&quot;</span><span class="token punctuation">)</span>
        models<span class="token punctuation">.</span>Classes<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>name<span class="token operator">=</span>class_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">&quot;/class_list/&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;add_class.html&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="使用装饰器装饰cbv"><a href="#使用装饰器装饰cbv" class="header-anchor">#</a> 使用装饰器装饰CBV</h3> <p>类中的方法与独立函数不完全相同，因此不能直接将函数装饰器应用于类中的方法 ，我们需要先将其转换为方法装饰器。</p> <p>Django中提供了method_decorator装饰器用于将函数装饰器转换为方法装饰器。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># CBV版添加班级</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>views <span class="token keyword">import</span> View
<span class="token keyword">from</span> django<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> method_decorator

<span class="token keyword">class</span> <span class="token class-name">AddClass</span><span class="token punctuation">(</span>View<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token decorator annotation punctuation">@method_decorator</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;add_class.html&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        class_name <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;class_name&quot;</span><span class="token punctuation">)</span>
        models<span class="token punctuation">.</span>Classes<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>name<span class="token operator">=</span>class_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">&quot;/class_list/&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="关于cbv的扩展阅读"><a href="#关于cbv的扩展阅读" class="header-anchor">#</a> 关于CBV的扩展阅读</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 使用CBV时要注意，请求过来后会先执行dispatch()这个方法，如果需要批量对具体的请求处理方法，如get，post等做一些操作的时候，这里我们可以手动改写dispatch方法，这个dispatch方法就和在FBV上加装饰器的效果一样。</span>

<span class="token keyword">class</span> <span class="token class-name">Login</span><span class="token punctuation">(</span>View<span class="token punctuation">)</span><span class="token punctuation">:</span>
     
    <span class="token keyword">def</span> <span class="token function">dispatch</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'before'</span><span class="token punctuation">)</span>
        obj <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span>Login<span class="token punctuation">,</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span>dispatch<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'after'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> obj
 
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">'login.html'</span><span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'Login.post'</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="request对象方法-request"><a href="#request对象方法-request" class="header-anchor">#</a> <strong>request对象方法（request）</strong></h1> <p>当一个页面被请求时，Django就会创建一个包含本次请求原信息的HttpRequest对象。
Django会将这个对象自动传递给响应的视图函数，一般视图函数约定俗成地使用 request 参数承接这个对象。</p> <p><a href="https://docs.djangoproject.com/en/1.11/ref/request-response/" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="请求相关的常用值"><a href="#请求相关的常用值" class="header-anchor">#</a> 请求相关的常用值</h2> <ol><li><strong>path_info</strong>   返回用户访问url，不包括域名</li> <li><strong>method</strong>    请求中使用的HTTP方法的字符串表示，全大写表示。</li> <li><strong>GET</strong>       包含所有HTTP  GET参数的类字典对象</li> <li><strong>POST</strong>      包含所有HTTP POST参数的类字典对象</li> <li><strong>body</strong>      请求体，byte类型 request.POST的数据就是从body里面提取到的</li></ol> <h2 id="属性"><a href="#属性" class="header-anchor">#</a> <strong>属性</strong></h2> <p>所有的属性应该被认为是只读的，除非另有说明。</p> <p>属性：</p> <ol><li>django将请求报文中的请求行、头部信息、内容主体封装成 HttpRequest 类中的属性。</li> <li>除了特殊说明的之外，其他均为只读的</li></ol> <h3 id="scheme-显示请求方案的字符串"><a href="#scheme-显示请求方案的字符串" class="header-anchor">#</a> scheme - 显示请求方案的字符串</h3> <p>表示请求方案的字符串（通常为http或https）</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>scheme<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="body-代表请求报文的主体"><a href="#body-代表请求报文的主体" class="header-anchor">#</a> body - 代表请求报文的主体</h3> <p>一个字符串，代表请求报文的主体。在处理非 HTTP 形式的报文时非常有用，例如：二进制图片、XML,Json等。</p> <p>但是，如果要处理表单数据的时候，推荐还是使用 HttpRequest.POST 。</p> <p>另外，我们还可以用 python 的类文件方法去操作它，详情参考 HttpRequest.read() 。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>body<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="path-表示请求的路径"><a href="#path-表示请求的路径" class="header-anchor">#</a> path - 表示请求的路径</h3> <p>一个字符串，表示请求的路径组件（不含域名）。</p> <p>例如：&quot;/music/bands/the_beatles/&quot;</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="method-表示请求使用的http"><a href="#method-表示请求使用的http" class="header-anchor">#</a> method - 表示请求使用的HTTP</h3> <p>一个字符串，表示请求使用的HTTP 方法。必须使用大写。</p> <p>例如：&quot;GET&quot;、&quot;POST&quot;</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>method<span class="token punctuation">)</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="encoding-表示提交的数据的编码方式"><a href="#encoding-表示提交的数据的编码方式" class="header-anchor">#</a> encoding - 表示提交的数据的编码方式</h3> <p>一个字符串，表示提交的数据的编码方式（如果为 None 则表示使用 DEFAULT_CHARSET 的设置，默认为 'utf-8'）。</p> <ol><li>这个属性是可写的，你可以修改它来修改访问表单数据使用的编码。</li> <li>接下来对属性的任何访问（例如从 GET 或 POST 中读取数据）将使用新的 encoding 值。</li> <li>如果你知道表单数据的编码不是 DEFAULT_CHARSET ，则使用它</li></ol> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>encoding<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="get-请求类型数据"><a href="#get-请求类型数据" class="header-anchor">#</a> GET - 请求类型数据</h3> <p>一个类似于字典的对象，包含 HTTP GET 的所有参数。详情请参考 QueryDict 对象。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="post-请求类型数据"><a href="#post-请求类型数据" class="header-anchor">#</a> POST - 请求类型数据</h3> <p>一个类似于字典的对象，如果请求中包含表单数据，则将这些数据封装成 QueryDict 对象。</p> <p>POST 请求可以带有空的 POST 字典 —— 如果通过 HTTP POST 方法发送一个表单，但是表单中没有任何的数据，QueryDict 对象依然会被创建。</p> <p>因此，不应该使用 if request.POST  来检查使用的是否是POST 方法；应该使用 if request.method == &quot;POST&quot;</p> <p>另外：如果使用 POST 上传文件的话，文件信息将包含在 FILES 属性中</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="cookies-包含所有的cookie"><a href="#cookies-包含所有的cookie" class="header-anchor">#</a> COOKIES - 包含所有的cookie</h3> <p>一个标准的Python 字典，包含所有的cookie。键和值都为字符串</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>COOKIES<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="files-包含所有的上传文件信息"><a href="#files-包含所有的上传文件信息" class="header-anchor">#</a> FILES - 包含所有的上传文件信息</h3> <p>一个类似于字典的对象，包含所有的上传文件信息。</p> <p>FILES 中的每个键为<input type="file" name=""> 中的name，值则为对应的数据。</p> <p>注意，FILES 只有在请求的方法为POST 且提交的</p><form> 带有enctype=&quot;multipart/form-data&quot; 的情况下才会包含数据。否则，FILES 将为一个空的类似于字典的对象<p></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>FILES<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="meta-包含所有的http-首部"><a href="#meta-包含所有的http-首部" class="header-anchor">#</a> META - 包含所有的HTTP 首部</h3> <p>一个标准的Python 字典，包含所有的HTTP 首部。具体的头部信息取决于客户端和服务器，下面是一些示例：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>META<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><ol><li>CONTENT_LENGTH —— 请求的正文的长度（是一个字符串）。</li> <li>CONTENT_TYPE —— 请求的正文的MIME 类型。</li> <li>HTTP_ACCEPT —— 响应可接收的Content-Type。</li> <li>HTTP_ACCEPT_ENCODING —— 响应可接收的编码。</li> <li>HTTP_ACCEPT_LANGUAGE —— 响应可接收的语言。</li> <li>HTTP_HOST —— 客服端发送的HTTP Host 头部。</li> <li>HTTP_REFERER —— Referring 页面。</li> <li>HTTP_USER_AGENT —— 客户端的user-agent 字符串。</li> <li>QUERY_STRING —— 单个字符串形式的查询字符串（未解析过的形式）。</li> <li>REMOTE_ADDR —— 客户端的IP 地址。</li> <li>REMOTE_HOST —— 客户端的主机名。</li> <li>REMOTE_USER —— 服务器认证后的用户。</li> <li>REQUEST_METHOD —— 一个字符串，例如&quot;GET&quot; 或&quot;POST&quot;。</li> <li>SERVER_NAME —— 服务器的主机名。</li> <li>SERVER_PORT —— 服务器的端口（是一个字符串）。</li></ol> <p>从上面可以看到，除 CONTENT_LENGTH 和 CONTENT_TYPE 之外，请求中的任何 HTTP 首部转换为 META 的键时，都会将所有字母大写并将连接符替换为下划线最后加上 HTTP_  前缀。</p> <p>所以，一个叫做 X-Bender 的头部将转换成 META 中的 HTTP_X_BENDER 键。</p> <h3 id="user-表示当前登录的用户"><a href="#user-表示当前登录的用户" class="header-anchor">#</a> user - 表示当前登录的用户</h3> <p>一个 AUTH_USER_MODEL 类型的对象，表示当前登录的用户。</p> <p>如果用户当前没有登录，user 将设置为 django.contrib.auth.models.AnonymousUser 的一个实例。你可以通过 is_authenticated() 区分它们</p> <div class="language-python extra-class"><pre class="language-python"><code> 	<span class="token keyword">if</span> request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>is_authenticated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Do something for logged-in users.</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># Do something for anonymous users.</span>
     

     　　user 只有当Django 启用 AuthenticationMiddleware 中间件时才可用。

     <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>

    匿名用户
    <span class="token keyword">class</span> <span class="token class-name">models</span><span class="token punctuation">.</span>AnonymousUser

    django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models<span class="token punctuation">.</span>AnonymousUser 类实现了django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models<span class="token punctuation">.</span>User 接口，但具有下面几个不同点：

    <span class="token builtin">id</span> 永远为<span class="token boolean">None</span>。
    username 永远为空字符串。
    get_username<span class="token punctuation">(</span><span class="token punctuation">)</span> 永远返回空字符串。
    is_staff 和 is_superuser 永远为<span class="token boolean">False</span>。
    is_active 永远为 <span class="token boolean">False</span>。
    groups 和 user_permissions 永远为空。
    is_anonymous<span class="token punctuation">(</span><span class="token punctuation">)</span> 返回<span class="token boolean">True</span> 而不是<span class="token boolean">False</span>。
    is_authenticated<span class="token punctuation">(</span><span class="token punctuation">)</span> 返回<span class="token boolean">False</span> 而不是<span class="token boolean">True</span>。
    set_password<span class="token punctuation">(</span><span class="token punctuation">)</span>、check_password<span class="token punctuation">(</span><span class="token punctuation">)</span>、save<span class="token punctuation">(</span><span class="token punctuation">)</span> 和delete<span class="token punctuation">(</span><span class="token punctuation">)</span> 引发 NotImplementedError。
    New <span class="token keyword">in</span> Django <span class="token number">1.8</span><span class="token punctuation">:</span>
    新增 AnonymousUser<span class="token punctuation">.</span>get_username<span class="token punctuation">(</span><span class="token punctuation">)</span> 以更好地模拟 django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models<span class="token punctuation">.</span>User。
</code></pre></div><h3 id="session-表示当前的会话"><a href="#session-表示当前的会话" class="header-anchor">#</a> session - 表示当前的会话</h3> <p>一个既可读又可写的类似于字典的对象，表示当前的会话。只有当Django 启用会话的支持时才可用。</p> <p>完整的细节参见会话的文档</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>session<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="上传文件示例"><a href="#上传文件示例" class="header-anchor">#</a> 上传文件示例</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    保存上传文件前，数据需要存放在某个位置。默认当上传文件小于2.5M时，django会将上传文件的全部内容读进内存。从内存读取一次，写磁盘一次。
    但当上传文件很大时，django会把上传文件写到临时文件中，然后存放到系统临时文件夹中。
    :param request: 
    :return: 
    &quot;&quot;&quot;</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">:</span>
        <span class="token comment"># 从请求的FILES中获取上传文件的文件名，file为页面上type=files类型input的name属性值</span>
        filename <span class="token operator">=</span> request<span class="token punctuation">.</span>FILES<span class="token punctuation">[</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name
        <span class="token comment"># 在项目目录下新建一个文件</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;wb&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            <span class="token comment"># 从上传的文件对象中一点一点读</span>
            <span class="token keyword">for</span> chunk <span class="token keyword">in</span> request<span class="token punctuation">.</span>FILES<span class="token punctuation">[</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>chunks<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># 写入本地文件</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">&quot;上传OK&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="方法大全"><a href="#方法大全" class="header-anchor">#</a> 方法大全</h2> <div class="language-python extra-class"><pre class="language-python"><code>
<span class="token number">1.</span>HttpRequest<span class="token punctuation">.</span>get_host<span class="token punctuation">(</span><span class="token punctuation">)</span>

　　根据从HTTP_X_FORWARDED_HOST（如果打开 USE_X_FORWARDED_HOST，默认为<span class="token boolean">False</span>）和 HTTP_HOST 头部信息返回请求的原始主机。
   如果这两个头部没有提供相应的值，则使用SERVER_NAME 和SERVER_PORT，在PEP <span class="token number">3333</span> 中有详细描述。

　　USE_X_FORWARDED_HOST：一个布尔值，用于指定是否优先使用 X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>Host 首部，仅在代理设置了该首部的情况下，才可以被使用。

　　例如：<span class="token string">&quot;127.0.0.1:8000&quot;</span>

　　注意：当主机位于多个代理后面时，get_host<span class="token punctuation">(</span><span class="token punctuation">)</span> 方法将会失败。除非使用中间件重写代理的首部。

 

<span class="token number">2.</span>HttpRequest<span class="token punctuation">.</span>get_full_path<span class="token punctuation">(</span><span class="token punctuation">)</span>

　　返回 path，如果可以将加上查询字符串。

　　例如：<span class="token string">&quot;/music/bands/the_beatles/?print=true&quot;</span>

 

<span class="token number">3.</span>HttpRequest<span class="token punctuation">.</span>get_signed_cookie<span class="token punctuation">(</span>key<span class="token punctuation">,</span> default<span class="token operator">=</span>RAISE_ERROR<span class="token punctuation">,</span> salt<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> max_age<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>

　　返回签名过的Cookie 对应的值，如果签名不再合法则返回django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>signing<span class="token punctuation">.</span>BadSignature。

　　如果提供 default 参数，将不会引发异常并返回 default 的值。

　　可选参数salt 可以用来对安全密钥强力攻击提供额外的保护。max_age 参数用于检查Cookie 对应的时间戳以确保Cookie 的时间不会超过max_age 秒。

        复制代码
        <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> request<span class="token punctuation">.</span>get_signed_cookie<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
        <span class="token string">'Tony'</span>
        <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> request<span class="token punctuation">.</span>get_signed_cookie<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> salt<span class="token operator">=</span><span class="token string">'name-salt'</span><span class="token punctuation">)</span>
        <span class="token string">'Tony'</span> <span class="token comment"># 假设在设置cookie的时候使用的是相同的salt</span>
        <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> request<span class="token punctuation">.</span>get_signed_cookie<span class="token punctuation">(</span><span class="token string">'non-existing-cookie'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        KeyError<span class="token punctuation">:</span> <span class="token string">'non-existing-cookie'</span>    <span class="token comment"># 没有相应的键时触发异常</span>
        <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> request<span class="token punctuation">.</span>get_signed_cookie<span class="token punctuation">(</span><span class="token string">'non-existing-cookie'</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token boolean">False</span>
        <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> request<span class="token punctuation">.</span>get_signed_cookie<span class="token punctuation">(</span><span class="token string">'cookie-that-was-tampered-with'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        BadSignature<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    
        <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> request<span class="token punctuation">.</span>get_signed_cookie<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> max_age<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        SignatureExpired<span class="token punctuation">:</span> Signature age <span class="token number">1677.3839159</span> <span class="token operator">&gt;</span> <span class="token number">60</span> seconds
        <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> request<span class="token punctuation">.</span>get_signed_cookie<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> max_age<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">)</span>
        <span class="token boolean">False</span>
        复制代码
         


<span class="token number">4.</span>HttpRequest<span class="token punctuation">.</span>is_secure<span class="token punctuation">(</span><span class="token punctuation">)</span>

　　如果请求时是安全的，则返回<span class="token boolean">True</span>；即请求通是过 HTTPS 发起的。

 

<span class="token number">5.</span>HttpRequest<span class="token punctuation">.</span>is_ajax<span class="token punctuation">(</span><span class="token punctuation">)</span>

　　如果请求是通过XMLHttpRequest 发起的，则返回<span class="token boolean">True</span>，方法是检查 HTTP_X_REQUESTED_WITH 相应的首部是否是字符串<span class="token string">'XMLHttpRequest'</span>。

　　大部分现代的 JavaScript 库都会发送这个头部。如果你编写自己的 XMLHttpRequest 调用（在浏览器端），你必须手工设置这个值来让 is_ajax<span class="token punctuation">(</span><span class="token punctuation">)</span> 可以工作。

　　如果一个响应需要根据请求是否是通过AJAX 发起的，并且你正在使用某种形式的缓存例如Django 的 cache middleware， 
   你应该使用 vary_on_headers<span class="token punctuation">(</span><span class="token string">'HTTP_X_REQUESTED_WITH'</span><span class="token punctuation">)</span> 装饰你的视图以让响应能够正确地缓存。
</code></pre></div><p><strong>注意：键值对的值是多个的时候,比如checkbox类型的input标签，select标签，需要用：</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>getlist<span class="token punctuation">(</span><span class="token string">&quot;hobby&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="response对象"><a href="#response对象" class="header-anchor">#</a> Response对象</h1> <p>与由Django自动创建的HttpRequest对象相比，HttpResponse对象是我们的职责范围了。我们写的每个视图都需要实例化，填充和返回一个HttpResponse。</p> <p>HttpResponse类位于django.http模块中。</p> <h2 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h2> <p><strong>传递字符串</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse
response <span class="token operator">=</span> HttpResponse<span class="token punctuation">(</span><span class="token string">&quot;Here's the text of the Web page.&quot;</span><span class="token punctuation">)</span>
response <span class="token operator">=</span> HttpResponse<span class="token punctuation">(</span><span class="token string">&quot;Text only, please.&quot;</span><span class="token punctuation">,</span> content_type<span class="token operator">=</span><span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>设置或删除响应头信息</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>response <span class="token operator">=</span> HttpResponse<span class="token punctuation">(</span><span class="token punctuation">)</span>
response<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'text/html; charset=UTF-8'</span>
<span class="token keyword">del</span> response<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="属性-2"><a href="#属性-2" class="header-anchor">#</a> 属性</h2> <p>HttpResponse.content：响应内容</p> <p>HttpResponse.charset：响应内容的编码</p> <p>HttpResponse.status_code：响应的状态码</p> <h1 id="jsonresponse对象"><a href="#jsonresponse对象" class="header-anchor">#</a> JsonResponse对象</h1> <p>JsonResponse是HttpResponse的子类，专门用来生成JSON编码的响应。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> JsonResponse

response <span class="token operator">=</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'foo'</span><span class="token punctuation">:</span> <span class="token string">'bar'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>

<span class="token string">b'{&quot;foo&quot;: &quot;bar&quot;}'</span>
</code></pre></div><p>默认只能传递字典类型，如果要传递非字典类型需要设置一下safe关键字参数。</p> <div class="language-python extra-class"><pre class="language-python"><code>response <span class="token operator">=</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="django-shortcut-functions"><a href="#django-shortcut-functions" class="header-anchor">#</a> Django shortcut functions</h1> <p><a href="https://docs.djangoproject.com/en/1.11/topics/http/shortcuts/" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="render"><a href="#render" class="header-anchor">#</a> render()</h2> <p><img src="https://s2.ax1x.com/2019/12/12/Qc1Hk6.png" alt="Qc1Hk6.png"></p> <p>结合一个给定的模板和一个给定的上下文字典，并返回一个渲染后的 HttpResponse 对象。</p> <p>参数：</p> <ol><li>request： 用于生成响应的请求对象。</li> <li>template_name：要使用的模板的完整名称，可选的参数</li> <li>context：添加到模板上下文的一个字典。默认是一个空字典。如果字典中的某个值是可调用的，视图将在渲染模板之前调用它。</li> <li>content_type：生成的文档要使用的MIME类型。默认为 DEFAULT_CONTENT_TYPE 设置的值。默认为'text/html'</li> <li>status：响应的状态码。默认为200。</li> <li>useing: 用于加载模板的模板引擎的名称。</li></ol> <p><strong>简单的例子</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render

<span class="token keyword">def</span> <span class="token function">my_view</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 视图的代码写在这里</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'myapp/index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'foo'</span><span class="token punctuation">:</span> <span class="token string">'bar'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>上面的代码等于</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse
<span class="token keyword">from</span> django<span class="token punctuation">.</span>template <span class="token keyword">import</span> loader

<span class="token keyword">def</span> <span class="token function">my_view</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 视图代码写在这里</span>
    t <span class="token operator">=</span> loader<span class="token punctuation">.</span>get_template<span class="token punctuation">(</span><span class="token string">'myapp/index.html'</span><span class="token punctuation">)</span>
    c <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'foo'</span><span class="token punctuation">:</span> <span class="token string">'bar'</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>t<span class="token punctuation">.</span>render<span class="token punctuation">(</span>c<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="redirect"><a href="#redirect" class="header-anchor">#</a> redirect()</h2> <p>参数可以是：</p> <ol><li>一个模型：将调用模型的<code>get_absolute_url()</code> 函数</li> <li>一个视图，可以带有参数：将使用<code>urlresolvers.reverse</code> 来反向解析名称</li> <li>一个绝对的或相对的URL，将原封不动的作为重定向的位置。</li></ol> <p>默认返回一个临时的重定向；传递<code>permanent=True</code> 可以返回一个永久的重定向。</p> <p><strong>传递一个具体的ORM对象（了解即可）</strong></p> <p>将调用具体ORM对象的<code>get_absolute_url()</code> 方法来获取重定向的URL：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> redirect
 
<span class="token keyword">def</span> <span class="token function">my_view</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token builtin">object</span> <span class="token operator">=</span> MyModel<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>传递一个视图的名称</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">my_view</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'some-view-name'</span><span class="token punctuation">,</span> foo<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>传递要重定向到的一个具体的网址</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">my_view</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/some/url/'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>当然也可以是一个完整的网址</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">my_view</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'http://example.com/'</span><span class="token punctuation">)</span>
</code></pre></div><p>默认情况下，<code>redirect()</code> 返回一个临时重定向。以上所有的形式都接收一个<code>permanent</code> 参数；如果设置为<code>True</code>，将返回一个永久的重定向：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">my_view</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token builtin">object</span> <span class="token operator">=</span> MyModel<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">,</span> permanent<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>　　
</code></pre></div><p><strong>扩展阅读：</strong></p> <p>临时重定向（响应状态码：302）和永久重定向（响应状态码：301）对普通用户来说是没什么区别的，它主要面向的是搜索引擎的机器人。</p> <p>A页面临时重定向到B页面，那搜索引擎收录的就是A页面。</p> <p>A页面永久重定向到B页面，那搜索引擎收录的就是B页面</p></form></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Python/7. Python-Django/76. Django模板语言之逻辑.html" class="prev">
        76. Django模板语言之逻辑
      </a></span> <span class="next"><a href="/Python/7. Python-Django/78. Django路由系统(url).html">
        78. Django路由系统(url)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d65bef42.js" defer></script><script src="/assets/js/2.2249178e.js" defer></script><script src="/assets/js/150.5bf39cb4.js" defer></script>
  </body>
</html>
